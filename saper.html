<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOROSaper</title>
    <style>
        /* –°—Ç–∏–ª–∏ Windows XP */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tahoma', 'Arial', sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #008080;
            padding: 20px;
            overflow-x: hidden;
        }
        
        /* ========== –¢–ï–ú–´ ========== */
        
        /* –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞ (Windows XP) */
        body.classic-theme {
            background: #008080;
        }
        
        /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ - –£–õ–£–ß–®–ï–ù–ù–ê–Ø */
        body.dark-theme {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
        }
        
        /* –•—ç–ª–ª–æ—É–∏–Ω —Ç–µ–º–∞ - –£–õ–£–ß–®–ï–ù–ù–ê–Ø */
        body.halloween-theme {
            background: linear-gradient(135deg, #0f0a05 0%, #2a1a0a 100%);
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(255, 102, 0, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 80% 20%, rgba(255, 69, 0, 0.1) 0%, transparent 20%);
        }
        
        /* –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∞—è —Ç–µ–º–∞ - –£–õ–£–ß–®–ï–ù–ù–ê–Ø */
        body.christmas-theme {
            background: linear-gradient(135deg, #0a1a0f 0%, #0a2a1a 100%);
            background-image: 
                radial-gradient(circle at 10% 90%, rgba(255, 0, 0, 0.1) 0%, transparent 15%),
                radial-gradient(circle at 90% 10%, rgba(0, 255, 0, 0.1) 0%, transparent 15%);
        }
        
        /* –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Ç–µ–º–∞ - –£–õ–£–ß–®–ï–ù–ù–ê–Ø */
        body.minimal-theme {
            background: #000000;
        }
        
        /* –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–µ –≥–∏—Ä–ª—è–Ω–¥—ã */
        .garland {
            position: fixed;
            width: 100%;
            height: 20px;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.7;
        }
        
        .garland.top {
            top: 0;
            background: repeating-linear-gradient(
                90deg,
                #ff0000,
                #ff0000 10px,
                #00ff00 10px,
                #00ff00 20px,
                #ffffff 20px,
                #ffffff 30px
            );
        }
        
        .garland.bottom {
            bottom: 0;
            background: repeating-linear-gradient(
                90deg,
                #00ff00,
                #00ff00 10px,
                #ffffff 10px,
                #ffffff 20px,
                #ff0000 20px,
                #ff0000 30px
            );
        }
        
        /* –û–∫–Ω–æ –≤ —Å—Ç–∏–ª–µ Windows XP */
        .xp-window {
            width: 100%;
            max-width: 1000px;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            background-color: #c0c0c0;
            box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.5);
            padding: 3px;
            position: relative;
            z-index: 1;
        }
        
        /* –¢–µ–º—ã –¥–ª—è –æ–∫–Ω–∞ */
        body.dark-theme .xp-window {
            background-color: #1a1a1a;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .xp-window {
            background-color: #2a1a0a;
            border-color: #ff7700 #5a3000 #5a3000 #ff7700;
        }
        
        body.christmas-theme .xp-window {
            background-color: #0a2a1a;
            border-color: #ff0000 #005500 #005500 #ff0000;
        }
        
        body.minimal-theme .xp-window {
            background-color: #000000;
            border-color: #ffffff #666666 #666666 #ffffff;
        }
        
        .title-bar {
            background: linear-gradient(90deg, #000080, #1084d0);
            color: white;
            padding: 3px 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
            height: 18px;
        }
        
        /* –¢–µ–º—ã –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
        body.dark-theme .title-bar {
            background: linear-gradient(90deg, #101020, #2a3a5a);
        }
        
        body.halloween-theme .title-bar {
            background: linear-gradient(90deg, #5a3000, #ff5500);
        }
        
        body.christmas-theme .title-bar {
            background: linear-gradient(90deg, #005500, #ff0000);
        }
        
        body.minimal-theme .title-bar {
            background: linear-gradient(90deg, #000000, #333333);
            color: #ffffff;
        }
        
        .window-controls {
            display: flex;
            gap: 2px;
        }
        
        .control-btn {
            width: 14px;
            height: 12px;
            font-size: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            background-color: #c0c0c0;
            cursor: pointer;
            color: black;
        }
        
        body.dark-theme .control-btn {
            background-color: #333333;
            border-color: #606060 #202020 #202020 #606060;
            color: white;
        }
        
        body.halloween-theme .control-btn {
            background-color: #ff7700;
            border-color: #ffaa00 #5a3000 #5a3000 #ffaa00;
        }
        
        body.christmas-theme .control-btn {
            background-color: #ff0000;
            border-color: #ffffff #005500 #005500 #ffffff;
            color: white;
        }
        
        body.minimal-theme .control-btn {
            background-color: #ffffff;
            border-color: #000000;
            color: #000000;
        }
        
        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .main-container {
            display: flex;
            gap: 20px;
            padding: 15px;
        }
        
        @media (max-width: 900px) {
            .main-container {
                flex-direction: column;
            }
        }
        
        .left-panel {
            flex: 1;
            min-width: 250px;
            max-width: 600px;
        }
        
        .right-panel {
            flex: 1;
            min-width: 250px;
            max-width: 350px;
        }
        
        /* –ú–µ–Ω—é –≤ —Å—Ç–∏–ª–µ XP */
        .menu-bar {
            background-color: #c0c0c0;
            border: 1px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            padding: 2px 0;
            margin-bottom: 8px;
            display: flex;
            font-size: 11px;
        }
        
        body.dark-theme .menu-bar {
            background-color: #2a2a2a;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .menu-bar {
            background-color: #ff7700;
            border-color: #ffaa00 #5a3000 #5a3000 #ffaa00;
        }
        
        body.christmas-theme .menu-bar {
            background-color: #005500;
            border-color: #00ff00 #003300 #003300 #00ff00;
        }
        
        body.minimal-theme .menu-bar {
            background-color: #000000;
            border-color: #ffffff #666666 #666666 #ffffff;
        }
        
        .menu-item {
            padding: 3px 8px;
            margin: 0 1px;
            cursor: pointer;
            position: relative;
            color: black;
        }
        
        body.dark-theme .menu-item {
            color: #ffffff;
        }
        
        body.halloween-theme .menu-item {
            color: #ffffff;
            font-weight: bold;
        }
        
        body.christmas-theme .menu-item {
            color: #ffffff;
            font-weight: bold;
        }
        
        body.minimal-theme .menu-item {
            color: #ffffff;
        }
        
        .menu-item:hover {
            background-color: #000080;
            color: white;
        }
        
        body.dark-theme .menu-item:hover {
            background-color: #2a5a9a;
        }
        
        body.halloween-theme .menu-item:hover {
            background-color: #ff3300;
        }
        
        body.christmas-theme .menu-item:hover {
            background-color: #ff0000;
        }
        
        body.minimal-theme .menu-item:hover {
            background-color: #ffffff;
            color: #000000;
        }
        
        .menu-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: #c0c0c0;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            min-width: 200px;
            display: none;
            z-index: 1000;
        }
        
        body.dark-theme .menu-dropdown {
            background-color: #2a2a2a;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .menu-dropdown {
            background-color: #ff7700;
            border-color: #ffaa00 #5a3000 #5a3000 #ffaa00;
        }
        
        body.christmas-theme .menu-dropdown {
            background-color: #005500;
            border-color: #00ff00 #003300 #003300 #00ff00;
        }
        
        body.minimal-theme .menu-dropdown {
            background-color: #000000;
            border-color: #ffffff #666666 #666666 #ffffff;
        }
        
        .menu-item:hover .menu-dropdown {
            display: block;
        }
        
        .dropdown-item {
            padding: 4px 20px 4px 10px;
            cursor: pointer;
            white-space: nowrap;
            color: black;
        }
        
        body.dark-theme .dropdown-item {
            color: #ffffff;
        }
        
        body.halloween-theme .dropdown-item {
            color: #ffffff;
        }
        
        body.christmas-theme .dropdown-item {
            color: #ffffff;
        }
        
        body.minimal-theme .dropdown-item {
            color: #ffffff;
        }
        
        .dropdown-item:hover {
            background-color: #000080;
            color: white;
        }
        
        body.dark-theme .dropdown-item:hover {
            background-color: #2a5a9a;
        }
        
        body.halloween-theme .dropdown-item:hover {
            background-color: #ff3300;
        }
        
        body.christmas-theme .dropdown-item:hover {
            background-color: #ff0000;
        }
        
        body.minimal-theme .dropdown-item:hover {
            background-color: #ffffff;
            color: #000000;
        }
        
        .dropdown-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .dropdown-item.disabled:hover {
            background-color: inherit;
            color: inherit;
        }
        
        /* –ò–≥—Ä–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .game-panel {
            background-color: #c0c0c0;
            border: 2px solid;
            border-color: #808080 #ffffff #ffffff #808080;
            padding: 10px;
            margin-bottom: 10px;
        }
        
        body.dark-theme .game-panel {
            background-color: #2a2a2a;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .game-panel {
            background-color: #3a2a1a;
            border-color: #ff7700 #3a2a1a #3a2a1a #ff7700;
        }
        
        body.christmas-theme .game-panel {
            background-color: #0a3a2a;
            border-color: #ff0000 #0a3a2a #0a3a2a #ff0000;
        }
        
        body.minimal-theme .game-panel {
            background-color: #000000;
            border-color: #ffffff #000000 #000000 #ffffff;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 5px;
            background-color: #c0c0c0;
            border: 2px inset;
        }
        
        body.dark-theme .game-header {
            background-color: #333333;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .game-header {
            background-color: #5a3000;
            border-color: #ff7700 #3a1a00 #3a1a00 #ff7700;
        }
        
        body.christmas-theme .game-header {
            background-color: #005500;
            border-color: #00ff00 #003300 #003300 #00ff00;
        }
        
        body.minimal-theme .game-header {
            background-color: #000000;
            border-color: #ffffff;
        }
        
        .counter {
            background-color: #000;
            color: #f00;
            font-family: 'LCD', 'Courier New', monospace;
            font-size: 24px;
            padding: 2px 5px;
            border: 2px inset #808080;
            min-width: 60px;
            text-align: center;
            font-weight: bold;
        }
        
        body.dark-theme .counter {
            background-color: #000;
            color: #ff3333;
        }
        
        body.halloween-theme .counter {
            background-color: #000;
            color: #ff5500;
        }
        
        body.christmas-theme .counter {
            background-color: #000;
            color: #ff3333;
        }
        
        body.minimal-theme .counter {
            background-color: #000000;
            color: #ffffff;
            border-color: #ffffff;
        }
        
        /* –°–º–∞–π–ª–∏–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–µ–º */
        .smiley-btn {
            width: 26px;
            height: 26px;
            font-size: 16px;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            background-color: #c0c0c0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        body.dark-theme .smiley-btn {
            background-color: #404040;
            border-color: #606060 #202020 #202020 #606060;
        }
        
        body.halloween-theme .smiley-btn {
            background-color: #ff7700;
            border-color: #ffaa00 #5a3000 #5a3000 #ffaa00;
        }
        
        body.halloween-theme .smiley-btn::after {
            content: 'üéÉ';
        }
        
        body.christmas-theme .smiley-btn {
            background-color: #005500;
            border-color: #00ff00 #003300 #003300 #00ff00;
        }
        
        body.christmas-theme .smiley-btn::after {
            content: 'üéÑ';
        }
        
        body.minimal-theme .smiley-btn {
            background-color: #ffffff;
            border-color: #000000;
            color: #000000;
        }
        
        .smiley-btn:hover {
            background-color: #e0e0e0;
        }
        
        body.dark-theme .smiley-btn:hover {
            background-color: #606060;
        }
        
        body.halloween-theme .smiley-btn:hover {
            background-color: #ff9900;
        }
        
        body.christmas-theme .smiley-btn:hover {
            background-color: #00aa00;
        }
        
        body.minimal-theme .smiley-btn:hover {
            background-color: #cccccc;
        }
        
        /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
        .game-board {
            display: grid;
            margin: 0 auto;
            background-color: #c0c0c0;
            border: 4px inset;
            grid-gap: 0;
            gap: 0;
            overflow: hidden;
        }
        
        body.dark-theme .game-board {
            background-color: #333333;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .game-board {
            background-color: #3a2a1a;
            border-color: #ff7700 #3a2a1a #3a2a1a #ff7700;
        }
        
        body.christmas-theme .game-board {
            background-color: #0a3a2a;
            border-color: #ff0000 #0a3a2a #0a3a2a #ff0000;
        }
        
        body.minimal-theme .game-board {
            background-color: #000000;
            border-color: #ffffff;
        }
        
        /* –ö–ª–µ—Ç–∫–∏ */
        .cell {
            width: 26px;
            height: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            cursor: default;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            background-color: #c0c0c0;
            user-select: none;
            box-sizing: border-box;
            position: relative;
            margin: 0;
            padding: 0;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∫–∞–Ω–µ—Ä–∞ */
        .cell.scanner-safe {
            background-color: rgba(0, 255, 0, 0.3) !important;
        }
        
        .cell.scanner-mine {
            background-color: rgba(255, 0, 0, 0.3) !important;
        }
        
        body.dark-theme .cell {
            background-color: #404040;
            border-color: #606060 #202020 #202020 #606060;
        }
        
        body.halloween-theme .cell {
            background-color: #5a3a2a;
            border-color: #ff9900 #5a3a2a #5a3a2a #ff9900;
        }
        
        body.christmas-theme .cell {
            background-color: #0a5a3a;
            border-color: #00ff00 #0a5a3a #0a5a3a #00ff00;
        }
        
        body.minimal-theme .cell {
            background-color: #ffffff;
            border-color: #000000;
            color: #000000;
        }
        
        .cell:hover {
            background-color: #e0e0e0;
        }
        
        body.dark-theme .cell:hover {
            background-color: #505050;
        }
        
        body.halloween-theme .cell:hover {
            background-color: #7a5a3a;
        }
        
        body.christmas-theme .cell:hover {
            background-color: #1a7a5a;
        }
        
        body.minimal-theme .cell:hover {
            background-color: #dddddd;
        }
        
        .cell.revealed {
            border: 1px solid #808080 !important;
            background-color: #c0c0c0;
        }
        
        body.dark-theme .cell.revealed {
            background-color: #2a2a2a;
            border-color: #404040 !important;
        }
        
        body.halloween-theme .cell.revealed {
            background-color: #4a3a2a;
            border-color: #ff7700 !important;
        }
        
        body.christmas-theme .cell.revealed {
            background-color: #1a6a4a;
            border-color: #00aa00 !important;
        }
        
        body.minimal-theme .cell.revealed {
            background-color: #000000;
            border-color: #ffffff !important;
            color: #ffffff;
        }
        
        .cell.flagged::before {
            content: 'üö©';
            font-size: 14px;
        }
        
        .cell.mine::before {
            content: 'üí£';
            font-size: 14px;
        }
        
        body.halloween-theme .cell.mine::before {
            content: 'üëª';
        }
        
        body.christmas-theme .cell.mine::before {
            content: '‚ùÑÔ∏è';
        }
        
        .cell.mine.revealed {
            background-color: #ff0000;
            animation: explode 0.5s ease;
        }
        
        @keyframes explode {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        /* –¶–≤–µ—Ç–∞ —Ü–∏—Ñ—Ä */
        .cell-1 { color: #0000ff; }
        .cell-2 { color: #008000; }
        .cell-3 { color: #ff0000; }
        .cell-4 { color: #000080; }
        .cell-5 { color: #800000; }
        .cell-6 { color: #008080; }
        .cell-7 { color: #000000; }
        .cell-8 { color: #808080; }
        
        body.dark-theme .cell-1 { color: #4ecdc4; }
        body.dark-theme .cell-2 { color: #a0d468; }
        body.dark-theme .cell-3 { color: #ff6b6b; }
        body.dark-theme .cell-4 { color: #6a11cb; }
        body.dark-theme .cell-7 { color: #ffffff; }
        
        body.halloween-theme .cell-1 { color: #ff5500; }
        body.halloween-theme .cell-2 { color: #ff9900; }
        body.halloween-theme .cell-3 { color: #ff0000; }
        body.halloween-theme .cell-4 { color: #8b4513; }
        body.halloween-theme .cell-5 { color: #990000; }
        
        body.christmas-theme .cell-1 { color: #ff3333; }
        body.christmas-theme .cell-2 { color: #00aa00; }
        body.christmas-theme .cell-3 { color: #ffffff; }
        body.christmas-theme .cell-4 { color: #0066ff; }
        body.christmas-theme .cell-5 { color: #ffaa00; }
        
        body.minimal-theme .cell-1 { color: #ffffff; }
        body.minimal-theme .cell-2 { color: #cccccc; }
        body.minimal-theme .cell-3 { color: #999999; }
        body.minimal-theme .cell-4 { color: #666666; }
        body.minimal-theme .cell-5 { color: #333333; }
        
        /* –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ */
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
            padding: 5px;
            background-color: #c0c0c0;
            border: 2px inset;
        }
        
        body.dark-theme .toolbar {
            background-color: #333333;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .toolbar {
            background-color: #5a3000;
            border-color: #ff7700 #3a1a00 #3a1a00 #ff7700;
        }
        
        body.christmas-theme .toolbar {
            background-color: #005500;
            border-color: #00ff00 #003300 #003300 #00ff00;
        }
        
        body.minimal-theme .toolbar {
            background-color: #000000;
            border-color: #ffffff;
        }
        
        .toolbar-btn {
            padding: 3px 8px;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            background-color: #c0c0c0;
            cursor: pointer;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 3px;
            color: black;
        }
        
        body.dark-theme .toolbar-btn {
            background-color: #404040;
            border-color: #606060 #202020 #202020 #606060;
            color: white;
        }
        
        body.halloween-theme .toolbar-btn {
            background-color: #ff9900;
            border-color: #ffcc00 #8b4513 #8b4513 #ffcc00;
            color: black;
        }
        
        body.christmas-theme .toolbar-btn {
            background-color: #00aa00;
            border-color: #00ff00 #005500 #005500 #00ff00;
            color: white;
        }
        
        body.minimal-theme .toolbar-btn {
            background-color: #ffffff;
            border-color: #000000;
            color: #000000;
        }
        
        .toolbar-btn:hover {
            background-color: #e0e0e0;
        }
        
        body.dark-theme .toolbar-btn:hover {
            background-color: #505050;
        }
        
        body.halloween-theme .toolbar-btn:hover {
            background-color: #ffaa00;
        }
        
        body.christmas-theme .toolbar-btn:hover {
            background-color: #00ff00;
            color: black;
        }
        
        body.minimal-theme .toolbar-btn:hover {
            background-color: #cccccc;
        }
        
        .toolbar-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .toolbar-btn.disabled:hover {
            background-color: inherit;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ - —Ç—É—Å–∫–ª–∞—è */
        #btn-analyze {
            opacity: 0.5;
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç–∏ */
        .perfection-bar {
            width: 100%;
            height: 16px;
            background-color: #c0c0c0;
            border: 2px inset;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }
        
        body.dark-theme .perfection-bar {
            background-color: #333333;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .perfection-bar {
            background-color: #5a3000;
            border-color: #ff7700 #3a1a00 #3a1a00 #ff7700;
        }
        
        body.christmas-theme .perfection-bar {
            background-color: #005500;
            border-color: #00ff00 #003300 #003300 #00ff00;
        }
        
        body.minimal-theme .perfection-bar {
            background-color: #000000;
            border-color: #ffffff;
        }
        
        .perfection-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ffff00, #00ff00);
            width: 100%;
            transition: width 0.5s ease;
        }
        
        body.halloween-theme .perfection-fill {
            background: linear-gradient(90deg, #990000, #ff6600, #ffff00);
        }
        
        body.christmas-theme .perfection-fill {
            background: linear-gradient(90deg, #ff0000, #ffffff, #00ff00);
        }
        
        body.minimal-theme .perfection-fill {
            background: linear-gradient(90deg, #000000, #666666, #ffffff);
        }
        
        .perfection-text {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: black;
            text-shadow: 0 0 2px white;
        }
        
        body.dark-theme .perfection-text {
            color: white;
            text-shadow: 0 0 2px black;
        }
        
        body.halloween-theme .perfection-text {
            color: white;
            text-shadow: 0 0 2px black;
        }
        
        body.christmas-theme .perfection-text {
            color: white;
            text-shadow: 0 0 2px #005500;
        }
        
        body.minimal-theme .perfection-text {
            color: white;
            text-shadow: 0 0 2px black;
        }
        
        /* –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */
        .stats-panel {
            background-color: #c0c0c0;
            border: 2px inset;
            padding: 10px;
            margin-bottom: 10px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        body.dark-theme .stats-panel {
            background-color: #2a2a2a;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .stats-panel {
            background-color: #3a2a1a;
            border-color: #ff7700 #3a2a1a #3a2a1a #ff7700;
        }
        
        body.christmas-theme .stats-panel {
            background-color: #0a3a2a;
            border-color: #ff0000 #0a3a2a #0a3a2a #ff0000;
        }
        
        body.minimal-theme .stats-panel {
            background-color: #000000;
            border-color: #ffffff;
            color: #ffffff;
        }
        
        .stats-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #000080;
        }
        
        body.dark-theme .stats-title {
            color: #4ecdc4;
        }
        
        body.halloween-theme .stats-title {
            color: #ff5500;
        }
        
        body.christmas-theme .stats-title {
            color: #ff3333;
        }
        
        body.minimal-theme .stats-title {
            color: #ffffff;
        }
        
        /* –ú–æ–Ω–µ—Ç–∫–∏ */
        .coins-display {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
            padding: 5px;
            background-color: #c0c0c0;
            border: 2px inset;
            font-weight: bold;
        }
        
        .coin-icon {
            color: gold;
            font-weight: bold;
        }
        
        /* –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è */
        .achievement {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px;
            margin-bottom: 3px;
            background-color: #e0e0e0;
            border: 1px solid #808080;
        }
        
        body.dark-theme .achievement {
            background-color: #333333;
            border-color: #404040;
        }
        
        body.halloween-theme .achievement {
            background-color: #5a3a2a;
            border-color: #ff7700;
        }
        
        body.christmas-theme .achievement {
            background-color: #1a5a3a;
            border-color: #00ff00;
        }
        
        body.minimal-theme .achievement {
            background-color: #1a1a1a;
            border-color: #ffffff;
        }
        
        .achievement.unlocked {
            background-color: #ffffcc;
        }
        
        body.dark-theme .achievement.unlocked {
            background-color: #ffff66;
            color: black;
        }
        
        body.halloween-theme .achievement.unlocked {
            background-color: #ffff99;
            color: black;
        }
        
        body.christmas-theme .achievement.unlocked {
            background-color: #ffffc0;
            color: black;
        }
        
        body.minimal-theme .achievement.unlocked {
            background-color: #ffffff;
            color: #000000;
        }
        
        .achievement-icon {
            font-size: 20px;
        }
        
        .achievement-info {
            flex: 1;
        }
        
        .achievement-name {
            font-weight: bold;
            font-size: 11px;
        }
        
        .achievement-desc {
            font-size: 9px;
            color: #666;
        }
        
        body.dark-theme .achievement-desc {
            color: #cccccc;
        }
        
        body.halloween-theme .achievement-desc {
            color: #cccccc;
        }
        
        body.christmas-theme .achievement-desc {
            color: #cccccc;
        }
        
        body.minimal-theme .achievement-desc {
            color: #cccccc;
        }
        
        /* –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è */
        .daily-quest {
            background-color: #e0e0e0;
            border: 1px solid #808080;
            padding: 8px;
            margin-bottom: 5px;
            font-size: 10px;
        }
        
        .quest-reward {
            color: gold;
            font-weight: bold;
        }
        
        .quest-completed {
            background-color: #ccffcc;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .xp-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .xp-modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: #c0c0c0;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            min-width: 400px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        body.dark-theme .modal-content {
            background-color: #2a2a2a;
            border-color: #404040 #101010 #101010 #404040;
        }
        
        body.halloween-theme .modal-content {
            background-color: #3a2a1a;
            border-color: #ff7700 #3a2a1a #3a2a1a #ff7700;
        }
        
        body.christmas-theme .modal-content {
            background-color: #0a3a2a;
            border-color: #ff0000 #0a3a2a #0a3a2a #ff0000;
        }
        
        body.minimal-theme .modal-content {
            background-color: #000000;
            border-color: #ffffff #000000 #000000 #ffffff;
            color: #ffffff;
        }
        
        .modal-header {
            background: linear-gradient(90deg, #000080, #1084d0);
            color: white;
            padding: 3px 5px;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        body.dark-theme .modal-header {
            background: linear-gradient(90deg, #101020, #2a3a5a);
        }
        
        body.halloween-theme .modal-header {
            background: linear-gradient(90deg, #5a3000, #ff5500);
        }
        
        body.christmas-theme .modal-header {
            background: linear-gradient(90deg, #005500, #ff0000);
        }
        
        body.minimal-theme .modal-header {
            background: linear-gradient(90deg, #000000, #333333);
        }
        
        .modal-body {
            padding: 15px;
            font-size: 11px;
        }
        
        body.dark-theme .modal-body {
            color: #cccccc;
        }
        
        body.halloween-theme .modal-body {
            color: #ffffff;
        }
        
        body.christmas-theme .modal-body {
            color: #ffffff;
        }
        
        .modal-footer {
            padding: 8px;
            text-align: right;
            background-color: #c0c0c0;
        }
        
        body.dark-theme .modal-footer {
            background-color: #2a2a2a;
        }
        
        body.halloween-theme .modal-footer {
            background-color: #3a2a1a;
        }
        
        body.christmas-theme .modal-footer {
            background-color: #0a3a2a;
        }
        
        body.minimal-theme .modal-footer {
            background-color: #000000;
        }
        
        .xp-button {
            padding: 4px 12px;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            background-color: #c0c0c0;
            cursor: pointer;
            font-size: 11px;
            min-width: 70px;
            color: black;
        }
        
        body.dark-theme .xp-button {
            background-color: #404040;
            border-color: #606060 #202020 #202020 #606060;
            color: white;
        }
        
        body.halloween-theme .xp-button {
            background-color: #ff9900;
            border-color: #ffcc00 #8b4513 #8b4513 #ffcc00;
            color: black;
        }
        
        body.christmas-theme .xp-button {
            background-color: #00aa00;
            border-color: #00ff00 #005500 #005500 #00ff00;
            color: white;
        }
        
        body.minimal-theme .xp-button {
            background-color: #ffffff;
            border-color: #000000;
            color: #000000;
        }
        
        .xp-button:hover {
            background-color: #e0e0e0;
        }
        
        body.dark-theme .xp-button:hover {
            background-color: #505050;
        }
        
        body.halloween-theme .xp-button:hover {
            background-color: #ffaa00;
        }
        
        body.christmas-theme .xp-button:hover {
            background-color: #00ff00;
            color: black;
        }
        
        body.minimal-theme .xp-button:hover {
            background-color: #cccccc;
        }
        
        /* –ù–æ–≤—ã–µ —Ä–µ–∂–∏–º—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ */
        .mode-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 5px;
            margin-top: 10px;
        }
        
        .mode-btn {
            padding: 8px;
            border: 2px solid;
            border-color: #ffffff #808080 #808080 #ffffff;
            background-color: #c0c0c0;
            cursor: pointer;
            font-size: 11px;
            text-align: center;
        }
        
        body.dark-theme .mode-btn {
            background-color: #404040;
            border-color: #606060 #202020 #202020 #606060;
            color: white;
        }
        
        body.halloween-theme .mode-btn {
            background-color: #ff9900;
            border-color: #ffcc00 #8b4513 #8b4513 #ffcc00;
            color: black;
        }
        
        body.christmas-theme .mode-btn {
            background-color: #00aa00;
            border-color: #00ff00 #005500 #005500 #00ff00;
            color: white;
        }
        
        body.minimal-theme .mode-btn {
            background-color: #ffffff;
            border-color: #000000;
            color: #000000;
        }
        
        .mode-btn:hover {
            background-color: #e0e0e0;
        }
        
        body.dark-theme .mode-btn:hover {
            background-color: #505050;
        }
        
        body.halloween-theme .mode-btn:hover {
            background-color: #ffaa00;
        }
        
        body.christmas-theme .mode-btn:hover {
            background-color: #00ff00;
            color: black;
        }
        
        body.minimal-theme .mode-btn:hover {
            background-color: #cccccc;
        }
        
        .mode-btn.active {
            background-color: #000080;
            color: white;
            border-color: #808080 #ffffff #ffffff #808080;
        }
        
        body.dark-theme .mode-btn.active {
            background-color: #2a5a9a;
        }
        
        body.halloween-theme .mode-btn.active {
            background-color: #ff3300;
            color: white;
        }
        
        body.christmas-theme .mode-btn.active {
            background-color: #ff0000;
            color: white;
        }
        
        body.minimal-theme .mode-btn.active {
            background-color: #000000;
            color: #ffffff;
            border-color: #ffffff #000000 #000000 #ffffff;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ —Ä–µ–∂–∏–º–æ–≤ "–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ" */
        .mode-btn.in-dev {
            opacity: 0.5;
            cursor: not-allowed;
            position: relative;
        }
        
        .mode-btn.in-dev:hover::after {
            content: '–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!';
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #000080;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 10px;
            white-space: nowrap;
            z-index: 100;
        }
        
        body.dark-theme .mode-btn.in-dev:hover::after {
            background: #2a5a9a;
        }
        
        body.halloween-theme .mode-btn.in-dev:hover::after {
            background: #ff3300;
        }
        
        body.christmas-theme .mode-btn.in-dev:hover::after {
            background: #ff0000;
        }
        
        body.minimal-theme .mode-btn.in-dev:hover::after {
            background: #000000;
            color: #ffffff;
            border: 1px solid #ffffff;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes wave {
            0% { background-color: inherit; }
            50% { background-color: #ffff00; }
            100% { background-color: inherit; }
        }
        
        .wave-animation {
            animation: wave 0.5s ease;
        }
        
        /* –û—Å–æ–±—ã–µ –∫–ª–µ—Ç–∫–∏ –∏ –±–æ–Ω—É—Å—ã */
        .cell.bonus {
            animation: pulse 2s infinite;
        }
        
        .cell.ghost::before {
            content: 'üëª';
            font-size: 12px;
        }
        
        .cell.ghost.revealed {
            background-color: #800080;
        }
        
        .cell.teleporter::before {
            content: 'üåÄ';
            font-size: 12px;
        }
        
        .cell.detonator::before {
            content: 'üí•';
            font-size: 12px;
        }
        
        .cell.magnet::before {
            content: 'üß≤';
            font-size: 12px;
        }
        
        .cell.chameleon {
            animation: chameleon 3s infinite;
        }
        
        @keyframes chameleon {
            0% { background-color: #ff0000; }
            25% { background-color: #00ff00; }
            50% { background-color: #0000ff; }
            75% { background-color: #ffff00; }
            100% { background-color: #ff00ff; }
        }
        
        /* –ü–∞–Ω–µ–ª—å –±–æ–Ω—É—Å–æ–≤ */
        .bonus-panel {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }
        
        .bonus-item {
            padding: 8px;
            border: 2px solid #808080;
            background-color: #e0e0e0;
            text-align: center;
            font-size: 11px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 70px;
        }
        
        body.dark-theme .bonus-item {
            background-color: #333333;
            border-color: #404040;
        }
        
        body.halloween-theme .bonus-item {
            background-color: #5a3a2a;
            border-color: #ff7700;
        }
        
        body.christmas-theme .bonus-item {
            background-color: #1a5a3a;
            border-color: #00ff00;
        }
        
        body.minimal-theme .bonus-item {
            background-color: #1a1a1a;
            border-color: #ffffff;
            color: #ffffff;
        }
        
        .bonus-count {
            font-weight: bold;
            color: #000080;
            font-size: 16px;
            margin: 5px 0;
        }
        
        body.dark-theme .bonus-count {
            color: #4ecdc4;
        }
        
        body.halloween-theme .bonus-count {
            color: #ff5500;
        }
        
        body.christmas-theme .bonus-count {
            color: #ff3333;
        }
        
        body.minimal-theme .bonus-count {
            color: #ffffff;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ */
        .reset-btn {
            background-color: #ff4444 !important;
            color: white !important;
            border-color: #ff8888 #880000 #880000 #ff8888 !important;
        }
        
        .reset-btn:hover {
            background-color: #ff6666 !important;
        }
        
        /* –ò–∫–æ–Ω–∫–∏ –±–æ–Ω—É—Å–æ–≤ */
        .bonus-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 900px) {
            .main-container {
                flex-direction: column;
            }
            
            .left-panel, .right-panel {
                width: 100%;
                max-width: 100%;
            }
            
            .game-board {
                max-width: 100%;
                overflow: auto;
            }
            
            .cell {
                width: 24px;
                height: 24px;
                font-size: 12px;
            }
            
            .bonus-panel {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .game-board {
                grid-gap: 0;
                gap: 0;
            }
            
            .cell {
                width: 22px;
                height: 22px;
                font-size: 11px;
            }
        }
        
        @media (max-width: 500px) {
            .cell {
                width: 20px;
                height: 20px;
                font-size: 10px;
            }
            
            .counter {
                font-size: 18px;
                min-width: 50px;
            }
            
            .mode-selector {
                grid-template-columns: 1fr;
            }
            
            .bonus-panel {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 400px) {
            .cell {
                width: 18px;
                height: 18px;
                font-size: 9px;
            }
        }
        
        /* –ó–≤—É–∫–æ–≤–∞—è –∏–∫–æ–Ω–∫–∞ */
        .sound-icon {
            font-size: 12px;
            margin-right: 3px;
        }
        
        /* –≠–∫—Å–ø–µ—Ä—Ç —Ä–µ–∂–∏–º —Ñ–∏–∫—Å */
        .expert-fix {
            overflow-x: auto;
            max-width: 100%;
        }
    </style>
</head>
<body class="classic-theme">
    <!-- –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–µ –≥–∏—Ä–ª—è–Ω–¥—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–æ–π —Ç–µ–º—ã) -->
    <div class="garland top" style="display: none;"></div>
    <div class="garland bottom" style="display: none;"></div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞ -->
    <div class="xp-modal" id="language-modal" style="display: flex;">
        <div class="modal-content">
            <div class="modal-header">
                DOROSaper - –í—ã–±–æ—Ä —è–∑—ã–∫–∞ / Language Selection
            </div>
            <div class="modal-body">
                <div style="text-align: center; padding: 20px;">
                    <h2 style="margin-bottom: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫ / Choose language</h2>
                    <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 30px;">
                        <button class="xp-button" id="btn-ru" style="padding: 15px; font-size: 16px;">
                            üá∑üá∫ –†—É—Å—Å–∫–∏–π (Russian)
                        </button>
                        <button class="xp-button" id="btn-en" style="padding: 15px; font-size: 16px;">
                            üá∫üá∏ English (–ê–Ω–≥–ª–∏–π—Å–∫–∏–π)
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞ -->
    <div class="xp-modal" id="exit-modal">
        <div class="modal-content">
            <div class="modal-header">
                –í–Ω–∏–º–∞–Ω–∏–µ!
            </div>
            <div class="modal-body">
                <div style="text-align: center; padding: 20px;">
                    <h2 style="margin-bottom: 20px; color: #ff0000;">–ö—É–¥–∞ —Å–æ–±—Ä–∞–ª—Å—è? üò†</h2>
                    <p style="font-size: 14px; margin-bottom: 20px;">
                        –ò–≥—Ä–∞ –µ—â–µ –Ω–µ –∑–∞–∫–æ–Ω—á–µ–Ω–∞! –î–∞–≤–∞–π –ø—Ä–æ—Ö–æ–¥–∏ –¥–æ –∫–æ–Ω—Ü–∞!
                    </p>
                    <p style="font-size: 12px; color: #666;">
                        (–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ —à—É—Ç–∫–∞, –º–æ–∂–µ—à—å –∑–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É –µ—Å–ª–∏ —Ö–æ—á–µ—à—å)
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="xp-button" id="exit-cancel">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∏–≥—Ä–µ</button>
                <button class="xp-button" id="exit-confirm">–í—Å–µ —Ä–∞–≤–Ω–æ –≤—ã–π—Ç–∏</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ Dev Console -->
    <div class="xp-modal" id="devconsole-modal">
        <div class="modal-content">
            <div class="modal-header">
                Dev Console üíª
                <div class="control-btn" id="close-devconsole">√ó</div>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 15px;">
                    <p><strong>–ö–æ–º–∞–Ω–¥—ã:</strong></p>
                    <ul style="font-size: 10px; margin-left: 15px;">
                        <li><code>add coins [—á–∏—Å–ª–æ]</code> - –¥–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–µ—Ç—ã</li>
                        <li><code>add perfection [—á–∏—Å–ª–æ]</code> - –¥–æ–±–∞–≤–∏—Ç—å –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å</li>
                        <li><code>add bonus [—Ç–∏–ø] [—á–∏—Å–ª–æ]</code> - –¥–æ–±–∞–≤–∏—Ç—å –±–æ–Ω—É—Å—ã</li>
                        <li><code>win</code> - –≤—ã–∏–≥—Ä–∞—Ç—å —Ç–µ–∫—É—â—É—é –∏–≥—Ä—É</li>
                        <li><code>unlock all</code> - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</li>
                        <li><code>clear</code> - –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å</li>
                    </ul>
                </div>
                <div style="margin-bottom: 10px;">
                    <input type="text" id="devconsole-input" 
                           style="width: 100%; padding: 5px; border: 2px inset; background: #000; color: #0f0; font-family: monospace;"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É...">
                </div>
                <div id="devconsole-output" 
                     style="height: 200px; overflow-y: auto; background: #000; color: #0f0; padding: 10px; font-family: monospace; font-size: 10px; border: 2px inset;">
                    Dev Console –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!<br>
                    –î–æ—Å—Ç—É–ø–Ω—ã–µ –±–æ–Ω—É—Å—ã: scanner, shield, teleport, magnet, detector, chameleon
                </div>
            </div>
            <div class="modal-footer">
                <button class="xp-button" id="devconsole-execute">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
                <button class="xp-button" id="devconsole-clear">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
        </div>
    </div>
    
    <div class="xp-window" style="display: none;">
        <div class="title-bar">
            <div>Minesweeper PLUS+</div>
            <div class="window-controls">
                <div class="control-btn" id="minimize-btn">_</div>
                <div class="control-btn" id="maximize-btn">‚ñ°</div>
                <div class="control-btn" id="close-btn">√ó</div>
            </div>
        </div>
        
        <div class="menu-bar">
            <div class="menu-item">
                –ò–≥—Ä–∞
                <div class="menu-dropdown">
                    <div class="dropdown-item" id="new-game">–ù–æ–≤–∞—è –∏–≥—Ä–∞</div>
                    <div class="dropdown-item" data-mode="novice">–ù–æ–≤–∏—á–æ–∫ (9x9)</div>
                    <div class="dropdown-item" data-mode="amateur">–õ—é–±–∏—Ç–µ–ª—å (16x16)</div>
                    <div class="dropdown-item" data-mode="expert">–≠–∫—Å–ø–µ—Ä—Ç (16x30)</div>
                    <div class="dropdown-item disabled" id="custom-mode">–û—Å–æ–±—ã–π —Ä–µ–∂–∏–º...</div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-item" data-mode="ghost">–ü—Ä–∏–∑—Ä–∞–∫–∏</div>
                    <div class="dropdown-item" data-mode="hardcore">–•–∞—Ä–¥–∫–æ—Ä</div>
                    <div class="dropdown-item" data-mode="learning">–û–±—É—á–µ–Ω–∏–µ</div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-item" id="daily-challenge">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-item reset-btn" id="reset-progress">–°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-item" id="exit">–í—ã—Ö–æ–¥</div>
                </div>
            </div>
            <div class="menu-item">
                –í–∏–¥
                <div class="menu-dropdown">
                    <div class="dropdown-item" data-theme="classic">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞</div>
                    <div class="dropdown-item" data-theme="dark">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</div>
                    <div class="dropdown-item" data-theme="halloween">–•—ç–ª–ª–æ—É–∏–Ω</div>
                    <div class="dropdown-item" data-theme="christmas">–†–æ–∂–¥–µ—Å—Ç–≤–æ</div>
                    <div class="dropdown-item" data-theme="minimal">–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏–∫</div>
                </div>
            </div>
            <div class="menu-item">
                –ë–æ–Ω—É—Å—ã
                <div class="menu-dropdown">
                    <div class="dropdown-item" id="use-teleport">–¢–µ–ª–µ–ø–æ—Ä—Ç</div>
                    <div class="dropdown-item" id="use-magnet">–ú–∞–≥–Ω–∏—Ç</div>
                    <div class="dropdown-item" id="use-detector">–î–µ—Ç–µ–∫—Ç–æ—Ä</div>
                    <div class="dropdown-item" id="use-chameleon">–•–∞–º–µ–ª–µ–æ–Ω</div>
                    <div class="dropdown-item" id="use-scan">–°–∫–∞–Ω–µ—Ä</div>
                    <div class="dropdown-item" id="use-shield">–©–∏—Ç</div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-item" id="shop">–ú–∞–≥–∞–∑–∏–Ω –±–æ–Ω—É—Å–æ–≤</div>
                </div>
            </div>
            <div class="menu-item">
                –ó–≤—É–∫
                <div class="menu-dropdown">
                    <div class="dropdown-item" id="sound-toggle">
                        <span class="sound-icon">üîä</span> –í–∫–ª/–í—ã–∫–ª –∑–≤—É–∫
                    </div>
                    <div class="dropdown-item" id="sound-volume-up">
                        <span class="sound-icon">‚ûï</span> –ì—Ä–æ–º—á–µ
                    </div>
                    <div class="dropdown-item" id="sound-volume-down">
                        <span class="sound-icon">‚ûñ</span> –¢–∏—à–µ
                    </div>
                </div>
            </div>
            <div class="menu-item">
                –°–ø—Ä–∞–≤–∫–∞
                <div class="menu-dropdown">
                    <div class="dropdown-item" id="tutorial">–û–±—É—á–µ–Ω–∏–µ</div>
                    <div class="dropdown-item" id="strategies">–°—Ç—Ä–∞—Ç–µ–≥–∏–∏</div>
                    <div class="dropdown-item" id="achievements">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                    <div class="dropdown-separator"></div>
                    <div class="dropdown-item" id="about">–û –ø—Ä–æ–≥—Ä–∞–º–º–µ</div>
                </div>
            </div>
        </div>
        
        <div class="main-container">
            <div class="left-panel">
                <div class="coins-display">
                    <span class="coin-icon">ü™ô</span>
                    <span id="coins-counter">0</span> –º–æ–Ω–µ—Ç
                </div>
                
                <div class="toolbar">
                    <button class="toolbar-btn" id="btn-new">
                        <span>üîÑ</span> –ù–æ–≤–∞—è
                    </button>
                    <button class="toolbar-btn" id="btn-hint">
                        <span>üí°</span> –ü–æ–¥—Å–∫–∞–∑–∫–∞ (<span id="hint-counter">3</span>)
                    </button>
                    <button class="toolbar-btn" id="btn-undo" disabled>
                        <span>‚Ü∂</span> –û—Ç–º–µ–Ω–∞ (<span id="undo-counter">3</span>)
                    </button>
                    <button class="toolbar-btn" id="btn-marks">
                        <span>?</span> –í–æ–ø—Ä–æ—Å—ã
                    </button>
                    <button class="toolbar-btn" id="btn-analyze" disabled style="opacity: 0.5;">
                        <span>üìä</span> –ê–Ω–∞–ª–∏–∑
                    </button>
                </div>
                
                <div class="perfection-bar">
                    <div class="perfection-fill" id="perfection-fill" style="width: 100%"></div>
                    <div class="perfection-text" id="perfection-text">–ò–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å: 100%</div>
                </div>
                
                <div class="game-panel">
                    <div class="game-header">
                        <div class="counter" id="mines-counter">010</div>
                        <button class="smiley-btn" id="smiley">üôÇ</button>
                        <div class="counter" id="time-counter">000</div>
                    </div>
                    
                    <div class="expert-fix">
                        <div class="game-board" id="game-board">
                            <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>
                
                <div class="bonus-panel" id="bonus-panel">
                    <!-- –ë–æ–Ω—É—Å—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <div class="right-panel">
                <div class="stats-panel">
                    <div class="stats-title">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã</div>
                    <div id="game-stats">
                        <div>–í—Ä–µ–º—è: <span id="stat-time">0</span> —Å–µ–∫</div>
                        <div>–ò–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å: <span id="stat-perfection">100%</span></div>
                        <div>–û—Ç–∫—Ä—ã—Ç–æ –∫–ª–µ—Ç–æ–∫: <span id="stat-opened">0</span></div>
                        <div>–ù–∞–π–¥–µ–Ω–æ –º–∏–Ω: <span id="stat-found">0/10</span></div>
                        <div>–í–∑–æ—Ä–≤–∞–Ω–æ –º–∏–Ω: <span id="stat-exploded">0</span></div>
                        <div>–ü–æ–¥—Å–∫–∞–∑–æ–∫ –æ—Å—Ç–∞–ª–æ—Å—å: <span id="stat-hints">3</span></div>
                    </div>
                    
                    <div class="stats-title" style="margin-top: 15px;">üìÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</div>
                    <div id="daily-quests">
                        <!-- –ó–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    </div>
                    
                    <div class="stats-title" style="margin-top: 15px;">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                    <div id="current-achievements">
                        <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    </div>
                </div>
                
                <div class="mode-selector">
                    <button class="mode-btn active" data-mode="normal">–û–±—ã—á–Ω—ã–π</button>
                    <button class="mode-btn" data-mode="ghost">–ü—Ä–∏–∑—Ä–∞–∫–∏</button>
                    <button class="mode-btn in-dev" data-mode="tournament">–¢—É—Ä–Ω–∏—Ä</button>
                    <button class="mode-btn in-dev" data-mode="timeless">–ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏</button>
                    <button class="mode-btn" data-mode="learning">–û–±—É—á–µ–Ω–∏–µ</button>
                    <button class="mode-btn" data-mode="hardcore">–•–∞—Ä–¥–∫–æ—Ä</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –í—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="xp-modal" id="results-modal">
        <div class="modal-content">
            <div class="modal-header">
                –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–≥—Ä—ã
                <div class="control-btn" id="close-results">√ó</div>
            </div>
            <div class="modal-body" id="results-content">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ JavaScript -->
            </div>
            <div class="modal-footer">
                <button class="xp-button" id="play-again">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                <button class="xp-button" id="share-result">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
    <div class="xp-modal" id="achievements-modal">
        <div class="modal-content">
            <div class="modal-header">
                –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                <div class="control-btn" id="close-achievements">√ó</div>
            </div>
            <div class="modal-body" id="achievements-content">
                <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–±—É—á–µ–Ω–∏—è -->
    <div class="xp-modal" id="tutorial-modal">
        <div class="modal-content">
            <div class="modal-header">
                –û–±—É—á–µ–Ω–∏–µ
                <div class="control-btn" id="close-tutorial">√ó</div>
            </div>
            <div class="modal-body" id="tutorial-content">
                <div style="margin-bottom: 15px;">
                    <h3 style="color: #000080; margin-bottom: 10px;">–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:</h3>
                    <p>‚Ä¢ <strong>–õ–µ–≤—ã–π –∫–ª–∏–∫</strong> - –æ—Ç–∫—Ä—ã—Ç—å –∫–ª–µ—Ç–∫—É</p>
                    <p>‚Ä¢ <strong>–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫</strong> - –ø–æ—Å—Ç–∞–≤–∏—Ç—å/—É–±—Ä–∞—Ç—å —Ñ–ª–∞–∂–æ–∫</p>
                    <p>‚Ä¢ <strong>–¶–∏—Ñ—Ä—ã</strong> –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω –≤–æ–∫—Ä—É–≥</p>
                    <p>‚Ä¢ <strong>–¶–µ–ª—å:</strong> –æ—Ç–∫—Ä—ã—Ç—å –≤—Å–µ –∫–ª–µ—Ç–∫–∏ –±–µ–∑ –º–∏–Ω</p>
                </div>
                <div style="margin-bottom: 15px;">
                    <h3 style="color: #000080; margin-bottom: 10px;">–ù–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏:</h3>
                    <p>‚Ä¢ <strong>–ò–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å</strong> - —á–µ–º –º–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫, —Ç–µ–º –≤—ã—à–µ</p>
                    <p>‚Ä¢ <strong>–ë–æ–Ω—É—Å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏</strong> - –¥–∞—é—Ç –æ—Å–æ–±—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏</p>
                    <p>‚Ä¢ <strong>–†–µ–∂–∏–º—ã –∏–≥—Ä—ã</strong> - —Ä–∞–∑–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å</p>
                    <p>‚Ä¢ <strong>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</strong> - –∑–∞ –æ—Å–æ–±—ã–µ –∑–∞—Å–ª—É–≥–∏</p>
                </div>
                <div id="tutorial-step-content">
                    <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –ø–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="xp-button" id="prev-tutorial">–ù–∞–∑–∞–¥</button>
                <button class="xp-button" id="next-tutorial">–î–∞–ª–µ–µ</button>
                <button class="xp-button" id="close-tutorial-btn">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∞–≥–∞–∑–∏–Ω–∞ -->
    <div class="xp-modal" id="shop-modal">
        <div class="modal-content">
            <div class="modal-header">
                –ú–∞–≥–∞–∑–∏–Ω –±–æ–Ω—É—Å–æ–≤
                <div class="control-btn" id="close-shop">√ó</div>
            </div>
            <div class="modal-body" id="shop-content">
                <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π -->
    <div class="xp-modal" id="daily-modal">
        <div class="modal-content">
            <div class="modal-header">
                –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
                <div class="control-btn" id="close-daily">√ó</div>
            </div>
            <div class="modal-body" id="daily-content">
                <!-- –ó–∞–¥–∞–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –±–æ–º–±—É –≤ –æ–±—É—á–µ–Ω–∏–∏ -->
    <div class="xp-modal" id="mistake-modal">
        <div class="modal-content">
            <div class="modal-header">
                –ù–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å!
                <div class="control-btn" id="close-mistake">√ó</div>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="font-size: 48px; margin-bottom: 10px;">üòä</div>
                    <div style="font-weight: bold; margin-bottom: 10px;">–í—Å–µ –æ—à–∏–±–∞—é—Ç—Å—è!</div>
                    <p>–í –æ–±—É—á–µ–Ω–∏–∏ –º–æ–∂–Ω–æ –Ω–∞–∂–∏–º–∞—Ç—å –Ω–∞ –±–æ–º–±—ã –±–µ–∑ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π.</p>
                    <p>–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞ —Å–ª–æ–∂–Ω–æ —É–≥–∞–¥–∞—Ç—å –≤—Å–µ –º–∏–Ω—ã.</p>
                    <p>–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ —Å–∫–æ—Ä–æ –≤—ã —Å—Ç–∞–Ω–µ—Ç–µ —ç–∫—Å–ø–µ—Ä—Ç–æ–º!</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="xp-button" id="continue-learning">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò ==========
        const CONFIG = {
            novice: { rows: 9, cols: 9, mines: 10, name: "–ù–æ–≤–∏—á–æ–∫", multiplier: 1 },
            amateur: { rows: 16, cols: 16, mines: 40, name: "–õ—é–±–∏—Ç–µ–ª—å", multiplier: 1.5 },
            expert: { rows: 16, cols: 30, mines: 99, name: "–≠–∫—Å–ø–µ—Ä—Ç", multiplier: 2 },
            hardcore: { rows: 16, cols: 30, mines: 198, name: "–•–∞—Ä–¥–∫–æ—Ä", multiplier: 2.5 },
            learning: { rows: 9, cols: 9, mines: 5, name: "–û–±—É—á–µ–Ω–∏–µ", multiplier: 0.5 }
        };
        
        const BONUSES = {
            scanner: { name: '–°–∫–∞–Ω–µ—Ä', icon: 'üì°', price: 10, effect: '–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±–ª–∞—Å—Ç—å 3x3' },
            shield: { name: '–©–∏—Ç', icon: 'üõ°Ô∏è', price: 15, effect: '–ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –º–∏–Ω—ã' },
            teleport: { name: '–¢–µ–ª–µ–ø–æ—Ä—Ç', icon: 'üåÄ', price: 20, effect: '–¢–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ' },
            magnet: { name: '–ú–∞–≥–Ω–∏—Ç', icon: 'üß≤', price: 12, effect: '–ü—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç —Ñ–ª–∞–∂–∫–∏ –∫ –º–∏–Ω–∞–º' },
            detector: { name: '–î–µ—Ç–µ–∫—Ç–æ—Ä', icon: 'üîç', price: 18, effect: '–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∏–Ω—ã –≤ —Å—Ç—Ä–æ–∫–µ/—Å—Ç–æ–ª–±—Ü–µ' },
            chameleon: { name: '–•–∞–º–µ–ª–µ–æ–Ω', icon: 'ü¶é', price: 25, effect: '–ú–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏' }
        };
        
        // –î–û–°–¢–ò–ñ–ï–ù–ò–Ø
        const ACHIEVEMENTS = [
            { id: 'first_win', name: '–ü–µ—Ä–≤–∞—è –∫—Ä–æ–≤—å', desc: '–í—ã–∏–≥—Ä–∞—Ç—å –ø–µ—Ä–≤—É—é –∏–≥—Ä—É', icon: 'ü•á', unlocked: false },
            { id: 'perfect_100', name: '–ò–¥–µ–∞–ª', desc: '–î–æ—Å—Ç–∏—á—å 100% –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç–∏', icon: 'üíØ', unlocked: false },
            { id: 'speedrun', name: '–°–ø—Ä–∏–Ω—Ç–µ—Ä', desc: '–ü–æ–±–µ–¥–∏—Ç—å –º–µ–Ω–µ–µ —á–µ–º –∑–∞ 30 —Å–µ–∫—É–Ω–¥', icon: '‚ö°', unlocked: false },
            { id: 'no_mistakes', name: '–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–∞–ø–µ—Ä', desc: '–ü–æ–±–µ–¥–∏—Ç—å –±–µ–∑ –≤–∑–æ—Ä–≤–∞–Ω–Ω—ã—Ö –º–∏–Ω', icon: 'üõ°Ô∏è', unlocked: false },
            { id: 'ghost_buster', name: '–û—Ö–æ—Ç–Ω–∏–∫ –∑–∞ –ø—Ä–∏–≤–∏–¥–µ–Ω–∏—è–º–∏', desc: '–ü–æ–±–µ–¥–∏—Ç—å –≤ —Ä–µ–∂–∏–º–µ "–ü—Ä–∏–∑—Ä–∞–∫–∏"', icon: 'üëª', unlocked: false },
            { id: 'hardcore_master', name: '–ú–∞—Å—Ç–µ—Ä —Ö–∞—Ä–¥–∫–æ—Ä–∞', desc: '–ü–æ–±–µ–¥–∏—Ç—å –≤ —Ä–µ–∂–∏–º–µ "–•–∞—Ä–¥–∫–æ—Ä"', icon: 'üíÄ', unlocked: false },
            { id: 'halloween_win', name: '–•—ç–ª–ª–æ—É–∏–Ω—Å–∫–∏–π —Å–∞–ø–µ—Ä', desc: '–ü–æ–±–µ–¥–∏—Ç—å –≤ —Ö—ç–ª–ª–æ—É–∏–Ω—Å–∫–æ–π —Ç–µ–º–µ', icon: 'üéÉ', unlocked: false },
            { id: 'christmas_win', name: '–†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–π —Å–∞–ø–µ—Ä', desc: '–ü–æ–±–µ–¥–∏—Ç—å –≤ —Ä–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–æ–π —Ç–µ–º–µ', icon: 'üéÑ', unlocked: false },
            { id: 'minimal_win', name: '–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç', desc: '–ü–æ–±–µ–¥–∏—Ç—å –≤ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π —Ç–µ–º–µ', icon: '‚¨ú', unlocked: false },
            { id: 'veteran', name: '–í–µ—Ç–µ—Ä–∞–Ω', desc: '–°—ã–≥—Ä–∞—Ç—å 50 –∏–≥—Ä', icon: 'üéñÔ∏è', unlocked: false },
            { id: 'champion', name: '–ß–µ–º–ø–∏–æ–Ω', desc: '–í—ã–∏–≥—Ä–∞—Ç—å 25 –∏–≥—Ä', icon: 'üèÜ', unlocked: false },
            { id: 'collector', name: '–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä', desc: '–°–æ–±—Ä–∞—Ç—å 100 –º–æ–Ω–µ—Ç', icon: 'ü™ô', unlocked: false },
            { id: 'lucky_one', name: '–í–µ–∑—É–Ω—á–∏–∫', desc: '–ù–∞–π—Ç–∏ –∞–ª–º–∞–∑–Ω—É—é –∫–ª–µ—Ç–∫—É', icon: 'üíé', unlocked: false },
            { id: 'perfectionist', name: '–ü–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏—Å—Ç', desc: '5 —Ä–∞–∑ –¥–æ—Å—Ç–∏—á—å 100% –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç–∏', icon: '‚ú®', unlocked: false },
            { id: 'quick_thinker', name: '–ë—ã—Å—Ç—Ä—ã–π –º—ã—Å–ª–∏—Ç–µ–ª—å', desc: '–í—ã–∏–≥—Ä–∞—Ç—å 3 –∏–≥—Ä—ã –ø–æ–¥—Ä—è–¥ –º–µ–Ω–µ–µ —á–µ–º –∑–∞ 5 –º–∏–Ω—É—Ç', icon: 'üß†', unlocked: false },
            { id: 'secret_1', name: '–°–µ–∫—Ä–µ—Ç–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ 1', desc: '???', icon: '‚ùì', unlocked: false, secret: true },
            { id: 'secret_2', name: '–°–µ–∫—Ä–µ—Ç–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ 2', desc: '???', icon: '‚ùì', unlocked: false, secret: true }
        ];
        
        // –ï–ñ–ï–î–ù–ï–í–ù–´–ï –ó–ê–î–ê–ù–ò–Ø
        const DAILY_QUESTS = [
            { id: 'daily_1', name: '–ù–æ–≤–∏—á–æ–∫ –¥–Ω—è', desc: '–í—ã–∏–≥—Ä–∞—Ç—å 1 –∏–≥—Ä—É', reward: 2, completed: false },
            { id: 'daily_2', name: '–ò–¥–µ–∞–ª–∏—Å—Ç', desc: '–î–æ—Å—Ç–∏—á—å 80% –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç–∏', reward: 5, completed: false },
            { id: 'daily_3', name: '–≠–∫—Å–ø–µ—Ä—Ç –¥–Ω—è', desc: '–í—ã–∏–≥—Ä–∞—Ç—å –≤ —Ä–µ–∂–∏–º–µ —ç–∫—Å–ø–µ—Ä—Ç–∞', reward: 8, completed: false }
        ];
        
        // ========== –°–û–°–¢–û–Ø–ù–ò–ï –ò–ì–†–´ ==========
        let gameState = {
            board: [],
            mines: [],
            revealed: [],
            flagged: [],
            gameOver: false,
            gameWon: false,
            firstClick: true,
            timer: null,
            seconds: 0,
            mode: 'normal',
            theme: 'classic',
            perfection: 100,
            minesExploded: 0,
            minesFound: 0,
            hintsLeft: 3,
            undosLeft: 3,
            coins: 0,
            playerBonuses: {
                scanner: 0,
                shield: 0,
                teleport: 0,
                magnet: 0,
                detector: 0,
                chameleon: 0
            },
            stats: {
                gamesPlayed: 0,
                gamesWon: 0,
                bestTime: 999,
                bestPerfection: 0,
                totalCoins: 0,
                achievements: [],
                perfectGames: 0,
                totalTime: 0
            },
            moveHistory: [],
            ghosts: [],
            learningStep: 0,
            dailyQuests: JSON.parse(JSON.stringify(DAILY_QUESTS)),
            lastDailyReset: null,
            language: 'ru',
            soundEnabled: true,
            soundVolume: 0.5
        };
        
        // ========== –ó–í–£–ö–ò ==========
        const SoundManager = {
            audioContext: null,
            sounds: {},
            
            init() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    this.loadSounds();
                } catch (e) {
                    console.log('Web Audio API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:', e);
                    gameState.soundEnabled = false;
                }
            },
            
            loadSounds() {
                // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—ã–µ –∑–≤—É–∫–∏ —Å –ø–æ–º–æ—â—å—é –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
                this.sounds = {
                    click: this.createBeep(800, 0.1),
                    bonus: this.createBeep(1200, 0.2),
                    explosion: this.createExplosionSound(),
                    win: this.createWinSound(),
                    lose: this.createLoseSound(),
                    flag: this.createBeep(600, 0.1)
                };
            },
            
            createBeep(frequency, duration) {
                return () => {
                    if (!gameState.soundEnabled || !this.audioContext) return;
                    
                    const oscillator = this.audioContext.createOscillator();
                    const gainNode = this.audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(this.audioContext.destination);
                    
                    oscillator.frequency.value = frequency;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(gameState.soundVolume * 0.3, this.audioContext.currentTime + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                    
                    oscillator.start(this.audioContext.currentTime);
                    oscillator.stop(this.audioContext.currentTime + duration);
                };
            },
            
            createExplosionSound() {
                return () => {
                    if (!gameState.soundEnabled || !this.audioContext) return;
                    
                    const duration = 1;
                    const oscillator = this.audioContext.createOscillator();
                    const gainNode = this.audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(this.audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(100, this.audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(50, this.audioContext.currentTime + duration);
                    
                    oscillator.type = 'sawtooth';
                    
                    gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(gameState.soundVolume * 0.5, this.audioContext.currentTime + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
                    
                    oscillator.start(this.audioContext.currentTime);
                    oscillator.stop(this.audioContext.currentTime + duration);
                };
            },
            
            createWinSound() {
                return () => {
                    if (!gameState.soundEnabled || !this.audioContext) return;
                    
                    const times = [0, 0.2, 0.4, 0.6];
                    const frequencies = [523.25, 659.25, 783.99, 1046.50]; // C5, E5, G5, C6
                    
                    times.forEach((time, i) => {
                        setTimeout(() => {
                            const oscillator = this.audioContext.createOscillator();
                            const gainNode = this.audioContext.createGain();
                            
                            oscillator.connect(gainNode);
                            gainNode.connect(this.audioContext.destination);
                            
                            oscillator.frequency.value = frequencies[i];
                            oscillator.type = 'sine';
                            
                            gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                            gainNode.gain.linearRampToValueAtTime(gameState.soundVolume * 0.3, this.audioContext.currentTime + 0.05);
                            gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 0.3);
                            
                            oscillator.start(this.audioContext.currentTime);
                            oscillator.stop(this.audioContext.currentTime + 0.3);
                        }, time * 1000);
                    });
                };
            },
            
            createLoseSound() {
                return () => {
                    if (!gameState.soundEnabled || !this.audioContext) return;
                    
                    const oscillator = this.audioContext.createOscillator();
                    const gainNode = this.audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(this.audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(200, this.audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(100, this.audioContext.currentTime + 1);
                    
                    oscillator.type = 'triangle';
                    
                    gainNode.gain.setValueAtTime(0, this.audioContext.currentTime);
                    gainNode.gain.linearRampToValueAtTime(gameState.soundVolume * 0.4, this.audioContext.currentTime + 0.1);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + 1);
                    
                    oscillator.start(this.audioContext.currentTime);
                    oscillator.stop(this.audioContext.currentTime + 1);
                };
            },
            
            play(soundName) {
                if (this.sounds[soundName]) {
                    this.sounds[soundName]();
                }
            },
            
            toggle() {
                gameState.soundEnabled = !gameState.soundEnabled;
                if (gameState.soundEnabled && this.audioContext && this.audioContext.state === 'suspended') {
                    this.audioContext.resume();
                }
                updateSoundDisplay();
                saveGameData();
                showMessage(gameState.soundEnabled ? '–ó–≤—É–∫ –≤–∫–ª—é—á–µ–Ω' : '–ó–≤—É–∫ –≤—ã–∫–ª—é—á–µ–Ω');
            },
            
            setVolume(volume) {
                gameState.soundVolume = Math.max(0, Math.min(1, volume));
                saveGameData();
            },
            
            volumeUp() {
                this.setVolume(gameState.soundVolume + 0.1);
                showMessage(`–ì—Ä–æ–º–∫–æ—Å—Ç—å: ${Math.round(gameState.soundVolume * 100)}%`);
            },
            
            volumeDown() {
                this.setVolume(gameState.soundVolume - 0.1);
                showMessage(`–ì—Ä–æ–º–∫–æ—Å—Ç—å: ${Math.round(gameState.soundVolume * 100)}%`);
            }
        };
        
        // ========== –§–£–ù–ö–¶–ò–ò –í–´–ë–û–†–ê –Ø–ó–´–ö–ê ==========
        function selectLanguage(lang) {
            gameState.language = lang;
            localStorage.setItem('minesweeper-language', lang);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
            document.getElementById('language-modal').style.display = 'none';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ –∏–≥—Ä—ã
            document.querySelector('.xp-window').style.display = 'block';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–≥—Ä—É
            initGame();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–Ω–µ—Ç
            updateCoinsDisplay();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            loadGameData();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–≤—É–∫–∏
            SoundManager.init();
        }
        
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ ==========
        function initGame() {
            let config;
            
            if (gameState.mode === 'hardcore') {
                config = { ...CONFIG.expert };
                config.mines = Math.floor(config.mines * 2);
                config.name = "–•–∞—Ä–¥–∫–æ—Ä";
                config.multiplier = 2.5;
            } else {
                config = CONFIG[gameState.mode] || CONFIG.novice;
            }
            
            resetGameState();
            
            if (gameState.timer) clearInterval(gameState.timer);
            gameState.seconds = 0;
            updateTimeDisplay();
            
            document.getElementById('mines-counter').textContent = config.mines.toString().padStart(3, '0');
            updateSmiley('üôÇ');
            
            createBoard(config.rows, config.cols);
            updateStatsDisplay();
            updateBonusPanel();
            updateAchievementsDisplay();
            updateDailyQuestsDisplay();
            updateSoundDisplay();
            
            if (gameState.mode === 'learning') {
                startTutorial();
            }
        }
        
        function resetGameState() {
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            gameState.board = Array(config.rows).fill().map(() => Array(config.cols).fill(0));
            gameState.revealed = Array(config.rows).fill().map(() => Array(config.cols).fill(false));
            gameState.flagged = Array(config.rows).fill().map(() => Array(config.cols).fill(false));
            gameState.gameOver = false;
            gameState.gameWon = false;
            gameState.firstClick = true;
            gameState.perfection = 100;
            gameState.minesExploded = 0;
            gameState.minesFound = 0;
            gameState.hintsLeft = 3;
            gameState.undosLeft = 3;
            gameState.moveHistory = [];
            gameState.ghosts = [];
            
            updatePerfectionDisplay();
            updateHintButton();
            updateUndoButton();
        }
        
        // ========== –°–û–ó–î–ê–ù–ò–ï –ò–ì–†–û–í–û–ì–û –ü–û–õ–Ø ==========
        function createBoard(rows, cols) {
            const gameBoard = document.getElementById('game-board');
            gameBoard.innerHTML = '';
            
            // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
            const cellSize = cols > 20 ? 22 : 26; // –ú–µ–Ω—å—à–∏–µ –∫–ª–µ—Ç–∫–∏ –¥–ª—è —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
            
            gameBoard.style.gridTemplateColumns = `repeat(${cols}, ${cellSize}px)`;
            gameBoard.style.gridTemplateRows = `repeat(${rows}, ${cellSize}px)`;
            gameBoard.style.width = `${cols * cellSize}px`;
            gameBoard.style.height = `${rows * cellSize}px`;
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∫–ª–µ—Ç–∫–∏
                    cell.style.width = `${cellSize}px`;
                    cell.style.height = `${cellSize}px`;
                    cell.style.fontSize = `${Math.max(10, cellSize - 8)}px`;
                    
                    cell.addEventListener('click', () => handleCellClick(row, col));
                    cell.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        handleRightClick(row, col);
                    });
                    
                    gameBoard.appendChild(cell);
                }
            }
        }
        
        // ========== –†–ê–ó–ú–ï–©–ï–ù–ò–ï –ú–ò–ù ==========
        function placeMines(firstRow, firstCol) {
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            const excluded = new Set();
            for (let dr = -1; dr <= 1; dr++) {
                for (let dc = -1; dc <= 1; dc++) {
                    const r = firstRow + dr;
                    const c = firstCol + dc;
                    if (r >= 0 && r < config.rows && c >= 0 && c < config.cols) {
                        excluded.add(`${r},${c}`);
                    }
                }
            }
            
            gameState.mines = [];
            while (gameState.mines.length < config.mines) {
                const row = Math.floor(Math.random() * config.rows);
                const col = Math.floor(Math.random() * config.cols);
                
                if (!excluded.has(`${row},${col}`) && 
                    !gameState.mines.some(m => m.row === row && m.col === col)) {
                    gameState.mines.push({ row, col });
                    gameState.board[row][col] = -1;
                }
            }
            
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (gameState.board[row][col] !== -1) {
                        gameState.board[row][col] = countAdjacentMines(row, col);
                    }
                }
            }
            
            startTimer();
            
            if (gameState.mode === 'ghost') {
                createGhostMines();
            }
        }
        
        function countAdjacentMines(row, col) {
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            let count = 0;
            
            for (let dr = -1; dr <= 1; dr++) {
                for (let dc = -1; dc <= 1; dc++) {
                    if (dr === 0 && dc === 0) continue;
                    
                    const r = row + dr;
                    const c = col + dc;
                    
                    if (r >= 0 && r < config.rows && c >= 0 && c < config.cols) {
                        if (gameState.board[r][c] === -1) {
                            count++;
                        }
                    }
                }
            }
            
            return count;
        }
        
        // ========== –†–ï–ñ–ò–ú –ü–†–ò–ó–†–ê–ö–û–í ==========
        function createGhostMines() {
            const config = CONFIG[gameState.mode] || CONFIG.novice;
            
            const ghostCount = Math.floor(config.mines * 0.2);
            gameState.ghosts = [];
            
            for (let i = 0; i < ghostCount; i++) {
                const row = Math.floor(Math.random() * config.rows);
                const col = Math.floor(Math.random() * config.cols);
                
                if (gameState.board[row][col] !== -1 && 
                    !gameState.ghosts.some(g => g.row === row && g.col === col)) {
                    gameState.ghosts.push({ row, col });
                    
                    const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
                    cell.classList.add('ghost');
                }
            }
        }
        
        // ========== –û–ë–†–ê–ë–û–¢–ö–ê –ö–õ–ò–ö–û–í ==========
        function handleCellClick(row, col) {
            if (gameState.gameOver || gameState.flagged[row][col]) return;
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ –∫–ª–∏–∫–∞
            SoundManager.play('click');
            
            saveMove();
            
            if (gameState.mode === 'learning') {
                handleLearningClick(row, col);
                return;
            }
            
            if (gameState.firstClick) {
                gameState.firstClick = false;
                placeMines(row, col);
            }
            
            revealCell(row, col);
            checkWinCondition();
        }
        
        function handleLearningClick(row, col) {
            if (gameState.firstClick) {
                gameState.firstClick = false;
                createLearningBoard(row, col);
                startTimer();
                showTutorialStep(1);
                return;
            }
            
            revealCell(row, col, true);
            checkWinCondition();
        }
        
        function createLearningBoard(firstRow, firstCol) {
            const config = CONFIG.learning;
            
            const excluded = new Set();
            for (let dr = -1; dr <= 1; dr++) {
                for (let dc = -1; dc <= 1; dc++) {
                    const r = firstRow + dr;
                    const c = firstCol + dc;
                    if (r >= 0 && r < config.rows && c >= 0 && c < config.cols) {
                        excluded.add(`${r},${c}`);
                    }
                }
            }
            
            gameState.mines = [];
            while (gameState.mines.length < config.mines) {
                const row = Math.floor(Math.random() * config.rows);
                const col = Math.floor(Math.random() * config.cols);
                
                if (!excluded.has(`${row},${col}`) && 
                    !gameState.mines.some(m => m.row === row && m.col === col)) {
                    gameState.mines.push({ row, col });
                    gameState.board[row][col] = -1;
                }
            }
            
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (gameState.board[row][col] !== -1) {
                        gameState.board[row][col] = countAdjacentMines(row, col);
                    }
                }
            }
        }
        
        function revealCell(row, col, isLearning = false) {
            if (gameState.revealed[row][col] || gameState.flagged[row][col]) return;
            
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            
            gameState.revealed[row][col] = true;
            cell.classList.add('revealed');
            
            const cellValue = gameState.board[row][col];
            
            const isGhost = gameState.ghosts.some(g => g.row === row && g.col === col);
            if (isGhost) {
                cell.classList.add('ghost', 'revealed');
                gameState.minesExploded++;
                updatePerfection(-10);
                updateStatsDisplay();
                SoundManager.play('explosion');
                return;
            }
            
            if (cellValue === -1) {
                if (isLearning) {
                    cell.classList.add('mine', 'revealed');
                    gameState.minesExploded++;
                    updatePerfection(-20);
                    updateStatsDisplay();
                    SoundManager.play('explosion');
                    showMistakeMessage();
                    return;
                }
                
                if (gameState.playerBonuses.shield > 0) {
                    gameState.playerBonuses.shield--;
                    updateBonusPanel();
                    updatePerfection(-5);
                    
                    SoundManager.play('bonus');
                    cell.textContent = 'üõ°Ô∏è';
                    setTimeout(() => {
                        cell.textContent = '';
                        revealCell(row, col, isLearning);
                    }, 500);
                    return;
                }
                
                gameState.minesExploded++;
                cell.classList.add('mine', 'revealed');
                updatePerfection(-20);
                updateStatsDisplay();
                updateSmiley('üò®');
                SoundManager.play('explosion');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å
                if (gameState.perfection <= 0) {
                    setTimeout(() => {
                        gameOver(false);
                        showMessage('–ò–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å —É–ø–∞–ª–∞ –¥–æ 0%! –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!');
                    }, 500);
                }
                return;
            }
            
            if (cellValue > 0) {
                cell.textContent = cellValue;
                cell.classList.add(`cell-${cellValue}`);
            } else {
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        if (dr === 0 && dc === 0) continue;
                        
                        const r = row + dr;
                        const c = col + dc;
                        
                        if (r >= 0 && r < config.rows && c >= 0 && c < config.cols) {
                            revealCell(r, c, isLearning);
                        }
                    }
                }
            }
        }
        
        function handleRightClick(row, col) {
            if (gameState.revealed[row][col] || gameState.gameOver) return;
            
            SoundManager.play('flag');
            
            saveMove();
            
            const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
            gameState.flagged[row][col] = !gameState.flagged[row][col];
            
            if (gameState.flagged[row][col]) {
                cell.classList.add('flagged');
                gameState.minesFound++;
            } else {
                cell.classList.remove('flagged');
                gameState.minesFound--;
            }
            
            updateMinesCounter();
            updateStatsDisplay();
        }
        
        // ========== –°–ò–°–¢–ï–ú–ê –ú–û–ù–ï–¢ ==========
        function addCoins(amount) {
            gameState.coins += amount;
            gameState.stats.totalCoins += amount;
            updateCoinsDisplay();
            saveGameData();
        }
        
        function awardCoinsForWin() {
            if (!gameState.gameWon) return;
            
            const perfection = Math.round(gameState.perfection);
            const config = CONFIG[gameState.mode] || CONFIG.novice;
            
            // –ë–∞–∑–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç (10% –æ—Ç –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç–∏)
            let coins = Math.floor(perfection / 10);
            
            // –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ –º–Ω–æ–∂–∏—Ç–µ–ª—å —Ä–µ–∂–∏–º–∞
            coins = Math.floor(coins * config.multiplier);
            
            // –ú–∏–Ω–∏–º—É–º 1 –º–æ–Ω–µ—Ç–∞
            coins = Math.max(1, coins);
            
            addCoins(coins);
            showMessage(`–ù–∞–≥—Ä–∞–¥–∞: ${coins} –º–æ–Ω–µ—Ç –∑–∞ –ø–æ–±–µ–¥—É!`);
        }
        
        // ========== –ú–ê–ì–ê–ó–ò–ù ==========
        function showShopModal() {
            const modal = document.getElementById('shop-modal');
            const content = document.getElementById('shop-content');
            
            let html = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">';
            
            for (const [type, bonus] of Object.entries(BONUSES)) {
                html += `
                    <div class="bonus-item" style="cursor: pointer;" onclick="buyBonus('${type}')">
                        <div class="bonus-icon">${bonus.icon}</div>
                        <div style="font-weight: bold;">${bonus.name}</div>
                        <div style="font-size: 9px;">${bonus.effect}</div>
                        <div style="color: gold; font-weight: bold; margin-top: 5px;">
                            ${bonus.price} ü™ô
                        </div>
                    </div>
                `;
            }
            
            html += '</div>';
            content.innerHTML = html;
            modal.classList.add('active');
        }
        
        function buyBonus(type) {
            const bonus = BONUSES[type];
            if (!bonus) return;
            
            if (gameState.coins >= bonus.price) {
                gameState.coins -= bonus.price;
                gameState.playerBonuses[type]++;
                
                updateCoinsDisplay();
                updateBonusPanel();
                saveGameData();
                
                SoundManager.play('bonus');
                showMessage(`–ö—É–ø–ª–µ–Ω ${bonus.name}!`);
                document.getElementById('shop-modal').classList.remove('active');
            } else {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!');
            }
        }
        
        // ========== DEV CONSOLE ==========
        function showDevConsole() {
            document.getElementById('devconsole-modal').classList.add('active');
            document.getElementById('devconsole-input').focus();
        }
        
        function executeDevCommand(command) {
            const output = document.getElementById('devconsole-output');
            const parts = command.toLowerCase().split(' ');
            const cmd = parts[0];
            const args = parts.slice(1);
            
            let result = `> ${command}\n`;
            
            switch(cmd) {
                case 'add':
                    if (args.length >= 2) {
                        const type = args[0];
                        const value = parseInt(args[1]);
                        
                        if (type === 'coins') {
                            addCoins(value);
                            result += `–î–æ–±–∞–≤–ª–µ–Ω–æ ${value} –º–æ–Ω–µ—Ç\n`;
                        } else if (type === 'perfection') {
                            updatePerfection(value);
                            result += `–ò–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ ${value}%\n`;
                        } else if (type === 'bonus' && args.length >= 3) {
                            const bonusType = args[1];
                            const bonusCount = parseInt(args[2]);
                            if (gameState.playerBonuses[bonusType] !== undefined) {
                                gameState.playerBonuses[bonusType] += bonusCount;
                                updateBonusPanel();
                                result += `–î–æ–±–∞–≤–ª–µ–Ω–æ ${bonusCount} ${bonusType}\n`;
                            }
                        }
                    }
                    break;
                    
                case 'win':
                    gameOver(true);
                    result += '–ò–≥—Ä–∞ –≤—ã–∏–≥—Ä–∞–Ω–∞!\n';
                    break;
                    
                case 'unlock':
                    if (args[0] === 'all') {
                        ACHIEVEMENTS.forEach(a => unlockAchievement(a.id));
                        result += '–í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã!\n';
                    }
                    break;
                    
                case 'clear':
                    output.innerHTML = '';
                    return;
                    
                default:
                    result += '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞\n';
            }
            
            output.innerHTML += result;
            output.scrollTop = output.scrollHeight;
        }
        
        // ========== –ï–ñ–ï–î–ù–ï–í–ù–´–ï –ó–ê–î–ê–ù–ò–Ø ==========
        function checkDailyQuestsReset() {
            const today = new Date().toDateString();
            if (gameState.lastDailyReset !== today) {
                gameState.dailyQuests = JSON.parse(JSON.stringify(DAILY_QUESTS));
                gameState.lastDailyReset = today;
                saveGameData();
            }
        }
        
        function updateDailyQuestsDisplay() {
            checkDailyQuestsReset();
            
            const container = document.getElementById('daily-quests');
            container.innerHTML = '';
            
            gameState.dailyQuests.forEach(quest => {
                const div = document.createElement('div');
                div.className = `daily-quest ${quest.completed ? 'quest-completed' : ''}`;
                div.innerHTML = `
                    <div style="font-weight: bold; font-size: 10px;">${quest.name}</div>
                    <div style="font-size: 9px; margin-bottom: 3px;">${quest.desc}</div>
                    <div style="color: gold; font-weight: bold;">–ù–∞–≥—Ä–∞–¥–∞: <span class="quest-reward">${quest.reward} ü™ô</span></div>
                `;
                container.appendChild(div);
            });
        }
        
        function checkDailyQuests() {
            gameState.dailyQuests.forEach(quest => {
                if (!quest.completed) {
                    if (quest.id === 'daily_1' && gameState.gameWon) {
                        quest.completed = true;
                        addCoins(quest.reward);
                    } else if (quest.id === 'daily_2' && gameState.perfection >= 80 && gameState.gameWon) {
                        quest.completed = true;
                        addCoins(quest.reward);
                    } else if (quest.id === 'daily_3' && gameState.mode === 'expert' && gameState.gameWon) {
                        quest.completed = true;
                        addCoins(quest.reward);
                    }
                }
            });
            
            updateDailyQuestsDisplay();
        }
        
        // ========== –ü–û–î–°–ö–ê–ó–ö–ò ==========
        function useHint() {
            if (gameState.hintsLeft <= 0 || gameState.gameOver || gameState.firstClick) {
                showMessage('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫!');
                return;
            }
            
            const config = CONFIG[gameState.mode] || CONFIG.novice;
            
            // –ù–∞—Ö–æ–¥–∏–º –Ω–µ–æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –º–∏–Ω—ã
            const hiddenMines = [];
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (gameState.board[row][col] === -1 && 
                        !gameState.flagged[row][col] && 
                        !gameState.revealed[row][col]) {
                        hiddenMines.push({ row, col });
                    }
                }
            }
            
            if (hiddenMines.length > 0) {
                const randomMine = hiddenMines[Math.floor(Math.random() * hiddenMines.length)];
                const cell = document.querySelector(`.cell[data-row="${randomMine.row}"][data-col="${randomMine.col}"]`);
                
                cell.classList.add('wave-animation');
                setTimeout(() => cell.classList.remove('wave-animation'), 1000);
                
                gameState.hintsLeft--;
                updatePerfection(-5); // –®—Ç—Ä–∞—Ñ –∑–∞ –ø–æ–¥—Å–∫–∞–∑–∫—É
                updateHintButton();
                updateStatsDisplay();
                
                SoundManager.play('bonus');
                showMessage(`–ü–æ–¥—Å–∫–∞–∑–∫–∞: –º–∏–Ω–∞ –≤ —Å—Ç—Ä–æ–∫–µ ${randomMine.row + 1}, —Å—Ç–æ–ª–±—Ü–µ ${randomMine.col + 1}`);
            } else {
                showMessage('–í—Å–µ –º–∏–Ω—ã —É–∂–µ –Ω–∞–π–¥–µ–Ω—ã!');
            }
        }
        
        // ========== –°–ò–°–¢–ï–ú–ê –ò–î–ï–ê–õ–¨–ù–û–°–¢–ò ==========
        function updatePerfection(value) {
            gameState.perfection = Math.max(0, Math.min(100, gameState.perfection + value));
            updatePerfectionDisplay();
            
            // –ï—Å–ª–∏ –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å —É–ø–∞–ª–∞ –¥–æ 0 –∏ –∏–≥—Ä–∞ –Ω–µ –æ–∫–æ–Ω—á–µ–Ω–∞
            if (gameState.perfection <= 0 && !gameState.gameOver) {
                gameOver(false);
                showMessage('–ò–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å —É–ø–∞–ª–∞ –¥–æ 0%! –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!');
            }
        }
        
        // ========== –¢–ê–ô–ú–ï–† ==========
        function startTimer() {
            if (gameState.timer) clearInterval(gameState.timer);
            
            gameState.timer = setInterval(() => {
                gameState.seconds++;
                updateTimeDisplay();
                updateStatsDisplay();
            }, 1000);
        }
        
        // ========== –ü–†–û–í–ï–†–ö–ê –ü–û–ë–ï–î–´ ==========
        function checkWinCondition() {
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            const totalCells = config.rows * config.cols;
            const revealedCount = gameState.revealed.flat().filter(Boolean).length;
            const safeCells = totalCells - config.mines;
            
            if (revealedCount === safeCells) {
                gameOver(true);
            }
        }
        
        function gameOver(isWin) {
            gameState.gameOver = true;
            gameState.gameWon = isWin;
            
            if (gameState.timer) {
                clearInterval(gameState.timer);
                gameState.timer = null;
            }
            
            gameState.stats.gamesPlayed++;
            gameState.stats.totalTime += gameState.seconds;
            
            if (isWin) {
                SoundManager.play('win');
                updateSmiley('üòé');
                
                awardCoinsForWin();
                checkDailyQuests();
                
                if (gameState.seconds < gameState.stats.bestTime) {
                    gameState.stats.bestTime = gameState.seconds;
                }
                if (gameState.perfection > gameState.stats.bestPerfection) {
                    gameState.stats.bestPerfection = gameState.perfection;
                }
                
                if (gameState.perfection >= 100) {
                    gameState.stats.perfectGames++;
                }
                
                checkAchievements();
                setTimeout(() => showResults(), 1000);
            } else {
                SoundManager.play('lose');
                updateSmiley('üòµ');
                setTimeout(() => showResults(), 1000);
            }
            
            updateStatsDisplay();
            saveGameData();
        }
        
        // ========== –î–û–°–¢–ò–ñ–ï–ù–ò–Ø ==========
        function checkAchievements() {
            if (gameState.gameWon && gameState.stats.gamesWon === 1) {
                unlockAchievement('first_win');
            }
            
            if (gameState.perfection >= 100) {
                unlockAchievement('perfect_100');
            }
            
            if (gameState.seconds < 30 && gameState.gameWon) {
                unlockAchievement('speedrun');
            }
            
            if (gameState.minesExploded === 0 && gameState.gameWon) {
                unlockAchievement('no_mistakes');
            }
            
            if (gameState.mode === 'ghost' && gameState.gameWon) {
                unlockAchievement('ghost_buster');
            }
            
            if (gameState.mode === 'hardcore' && gameState.gameWon) {
                unlockAchievement('hardcore_master');
            }
            
            if (gameState.gameWon) {
                if (gameState.theme === 'halloween') {
                    unlockAchievement('halloween_win');
                } else if (gameState.theme === 'christmas') {
                    unlockAchievement('christmas_win');
                } else if (gameState.theme === 'minimal') {
                    unlockAchievement('minimal_win');
                }
            }
            
            if (gameState.stats.gamesPlayed >= 50) {
                unlockAchievement('veteran');
            }
            
            if (gameState.stats.gamesWon >= 25) {
                unlockAchievement('champion');
            }
            
            if (gameState.stats.totalCoins >= 100) {
                unlockAchievement('collector');
            }
        }
        
        function unlockAchievement(id) {
            const achievement = ACHIEVEMENTS.find(a => a.id === id);
            if (achievement && !achievement.unlocked) {
                achievement.unlocked = true;
                gameState.stats.achievements.push(id);
                
                SoundManager.play('bonus');
                showMessage(`–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ: ${achievement.name}!`);
                updateAchievementsDisplay();
                saveGameData();
            }
        }
        
        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ==========
        function updateSmiley(emoji) {
            document.getElementById('smiley').textContent = emoji;
        }
        
        function updateMinesCounter() {
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            const flagged = gameState.flagged.flat().filter(Boolean).length;
            const remaining = config.mines - flagged;
            
            document.getElementById('mines-counter').textContent = 
                Math.max(0, remaining).toString().padStart(3, '0');
        }
        
        function updateCoinsDisplay() {
            document.getElementById('coins-counter').textContent = gameState.coins;
        }
        
        function updateStatsDisplay() {
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            document.getElementById('stat-time').textContent = gameState.seconds;
            document.getElementById('stat-perfection').textContent = `${Math.round(gameState.perfection)}%`;
            document.getElementById('stat-opened').textContent = 
                gameState.revealed.flat().filter(Boolean).length;
            document.getElementById('stat-found').textContent = 
                `${gameState.minesFound}/${config.mines}`;
            document.getElementById('stat-exploded').textContent = gameState.minesExploded;
            document.getElementById('stat-hints').textContent = gameState.hintsLeft;
        }
        
        function updateBonusPanel() {
            const panel = document.getElementById('bonus-panel');
            panel.innerHTML = '';
            
            for (const [type, count] of Object.entries(gameState.playerBonuses)) {
                if (count > 0 && BONUSES[type]) {
                    const item = document.createElement('div');
                    item.className = 'bonus-item';
                    item.innerHTML = `
                        <div class="bonus-icon">${BONUSES[type].icon}</div>
                        <div class="bonus-count">${count}</div>
                        <div style="font-size: 10px;">${BONUSES[type].name}</div>
                    `;
                    panel.appendChild(item);
                }
            }
            
            if (panel.innerHTML === '') {
                panel.innerHTML = '<div style="text-align: center; font-size: 10px; color: #808080; grid-column: 1/-1; padding: 20px;">–ë–æ–Ω—É—Å–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç<br><small>–ö—É–ø–∏—Ç–µ –∏—Ö –≤ –º–∞–≥–∞–∑–∏–Ω–µ!</small></div>';
            }
        }
        
        function updateAchievementsDisplay() {
            const container = document.getElementById('current-achievements');
            container.innerHTML = '';
            
            const unlocked = ACHIEVEMENTS.filter(a => a.unlocked && !a.secret).slice(-3);
            
            if (unlocked.length === 0) {
                container.innerHTML = '<div style="text-align: center; font-size: 10px; color: #808080;">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</div>';
                return;
            }
            
            unlocked.forEach(achievement => {
                const div = document.createElement('div');
                div.className = 'achievement unlocked';
                div.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <div class="achievement-info">
                        <div class="achievement-name">${achievement.name}</div>
                        <div class="achievement-desc">${achievement.desc}</div>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        function updateHintButton() {
            const btn = document.getElementById('btn-hint');
            const counter = document.getElementById('hint-counter');
            counter.textContent = gameState.hintsLeft;
            btn.disabled = gameState.hintsLeft <= 0;
        }
        
        function updateUndoButton() {
            const btn = document.getElementById('btn-undo');
            const counter = document.getElementById('undo-counter');
            counter.textContent = gameState.undosLeft;
            btn.disabled = gameState.undosLeft <= 0;
        }
        
        function updateSoundDisplay() {
            const soundIcon = document.querySelector('#sound-toggle .sound-icon');
            if (soundIcon) {
                soundIcon.textContent = gameState.soundEnabled ? 'üîä' : 'üîá';
            }
        }
        
        // ========== –°–ò–°–¢–ï–ú–ê –û–¢–ú–ï–ù–´ ==========
        function saveMove() {
            if (gameState.undosLeft <= 0) return;
            
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            const revealed = gameState.revealed.map(row => [...row]);
            const flagged = gameState.flagged.map(row => [...row]);
            
            gameState.moveHistory.push({
                revealed,
                flagged,
                minesFound: gameState.minesFound,
                minesExploded: gameState.minesExploded,
                perfection: gameState.perfection
            });
            
            updateUndoButton();
        }
        
        function undoMove() {
            if (gameState.moveHistory.length === 0 || gameState.undosLeft <= 0) return;
            
            const lastMove = gameState.moveHistory.pop();
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    gameState.revealed[row][col] = lastMove.revealed[row][col];
                    gameState.flagged[row][col] = lastMove.flagged[row][col];
                    
                    const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
                    cell.classList.toggle('revealed', lastMove.revealed[row][col]);
                    cell.classList.toggle('flagged', lastMove.flagged[row][col]);
                    
                    if (!lastMove.revealed[row][col]) {
                        cell.textContent = '';
                        cell.className = 'cell';
                        if (gameState.flagged[row][col]) {
                            cell.classList.add('flagged');
                        }
                    } else {
                        const value = gameState.board[row][col];
                        if (typeof value === 'number' && value > 0) {
                            cell.textContent = value;
                            cell.classList.add(`cell-${value}`);
                        }
                    }
                }
            }
            
            gameState.minesFound = lastMove.minesFound;
            gameState.minesExploded = lastMove.minesExploded;
            gameState.perfection = lastMove.perfection;
            gameState.undosLeft--;
            
            // –®—Ç—Ä–∞—Ñ –∑–∞ –æ—Ç–º–µ–Ω—É
            updatePerfection(-2);
            
            updateMinesCounter();
            updateStatsDisplay();
            updatePerfectionDisplay();
            updateUndoButton();
            showMessage('–•–æ–¥ –æ—Ç–º–µ–Ω–µ–Ω (-2% –∫ –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç–∏)');
        }
        
        // ========== –ë–û–ù–£–°–´ ==========
        function useBonus(bonusType) {
            if (gameState.playerBonuses[bonusType] <= 0) {
                showMessage(`–£ –≤–∞—Å –Ω–µ—Ç –±–æ–Ω—É—Å–∞ "${BONUSES[bonusType]?.name || bonusType}"!`);
                return;
            }
            
            gameState.playerBonuses[bonusType]--;
            updateBonusPanel();
            
            SoundManager.play('bonus');
            
            switch(bonusType) {
                case 'scanner':
                    useScanner();
                    break;
                case 'teleport':
                    useTeleport();
                    break;
                case 'magnet':
                    useMagnet();
                    break;
                case 'detector':
                    useDetector();
                    break;
                case 'chameleon':
                    useChameleon();
                    break;
                case 'shield':
                    // –©–∏—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                    showMessage('–©–∏—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –°–ª–µ–¥—É—é—â–∞—è –º–∏–Ω–∞ –±—É–¥–µ—Ç –æ–±–µ–∑–≤—Ä–µ–∂–µ–Ω–∞.');
                    break;
            }
            
            saveGameData();
        }
        
        function useScanner() {
            const config = CONFIG[gameState.mode] || CONFIG.novice;
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –æ–±–ª–∞—Å—Ç—å 3x3
            const centerRow = Math.floor(Math.random() * (config.rows - 2)) + 1;
            const centerCol = Math.floor(Math.random() * (config.cols - 2)) + 1;
            
            // –°–∫–∞–Ω–∏—Ä—É–µ–º –æ–±–ª–∞—Å—Ç—å 3x3
            for (let dr = -1; dr <= 1; dr++) {
                for (let dc = -1; dc <= 1; dc++) {
                    const r = centerRow + dr;
                    const c = centerCol + dc;
                    
                    if (r >= 0 && r < config.rows && c >= 0 && c < config.cols) {
                        const cell = document.querySelector(`.cell[data-row="${r}"][data-col="${c}"]`);
                        
                        if (gameState.board[r][c] === -1) {
                            // –ú–∏–Ω–∞ - –∫—Ä–∞—Å–Ω—ã–π
                            cell.classList.add('scanner-mine');
                        } else if (!gameState.revealed[r][c] && !gameState.flagged[r][c]) {
                            // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–ª–µ—Ç–∫–∞ - –∑–µ–ª–µ–Ω—ã–π
                            cell.classList.add('scanner-safe');
                        }
                        
                        setTimeout(() => {
                            cell.classList.remove('scanner-mine', 'scanner-safe');
                        }, 3000);
                    }
                }
            }
            
            showMessage('–°–∫–∞–Ω–µ—Ä –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –ö—Ä–∞—Å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ - –º–∏–Ω—ã, –∑–µ–ª–µ–Ω—ã–µ - –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ');
        }
        
        function useTeleport() {
            const config = CONFIG[gameState.mode] || CONFIG.novice;
            
            let safeRow = -1, safeCol = -1;
            
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (!gameState.revealed[row][col] && 
                        !gameState.flagged[row][col] && 
                        gameState.board[row][col] !== -1) {
                        safeRow = row;
                        safeCol = col;
                        break;
                    }
                }
                if (safeRow !== -1) break;
            }
            
            if (safeRow !== -1) {
                const cell = document.querySelector(`.cell[data-row="${safeRow}"][data-col="${safeCol}"]`);
                cell.classList.add('wave-animation');
                revealCell(safeRow, safeCol);
                
                showMessage('–¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–µ—Å—Ç–æ!');
            } else {
                showMessage('–ù–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫ –¥–ª—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏!');
            }
        }
        
        function useMagnet() {
            const config = CONFIG[gameState.mode] || CONFIG.novice;
            let flagsPlaced = 0;
            
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (gameState.board[row][col] === -1 && 
                        !gameState.flagged[row][col] && 
                        !gameState.revealed[row][col]) {
                        
                        gameState.flagged[row][col] = true;
                        gameState.minesFound++;
                        flagsPlaced++;
                        
                        const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
                        cell.classList.add('flagged');
                    }
                }
            }
            
            updateMinesCounter();
            updateStatsDisplay();
            
            if (flagsPlaced > 0) {
                showMessage(`–ú–∞–≥–Ω–∏—Ç –ø–æ—Å—Ç–∞–≤–∏–ª ${flagsPlaced} —Ñ–ª–∞–∂–∫–æ–≤ –Ω–∞ –º–∏–Ω—ã!`);
            } else {
                showMessage('–í—Å–µ –º–∏–Ω—ã —É–∂–µ –ø–æ–º–µ—á–µ–Ω—ã!');
            }
        }
        
        function useDetector() {
            const config = CONFIG[gameState.mode] || CONFIG.novice;
            
            const rowCounts = Array(config.rows).fill(0);
            const colCounts = Array(config.cols).fill(0);
            
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (gameState.board[row][col] === -1 && !gameState.revealed[row][col]) {
                        rowCounts[row]++;
                        colCounts[col]++;
                    }
                }
            }
            
            const maxRow = rowCounts.indexOf(Math.max(...rowCounts));
            const maxCol = colCounts.indexOf(Math.max(...colCounts));
            
            for (let col = 0; col < config.cols; col++) {
                const cell = document.querySelector(`.cell[data-row="${maxRow}"][data-col="${col}"]`);
                if (cell) {
                    cell.classList.add('wave-animation');
                    setTimeout(() => cell.classList.remove('wave-animation'), 1000);
                }
            }
            
            for (let row = 0; row < config.rows; row++) {
                const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${maxCol}"]`);
                if (cell) {
                    cell.classList.add('wave-animation');
                    setTimeout(() => cell.classList.remove('wave-animation'), 1000);
                }
            }
            
            showMessage(`–î–µ—Ç–µ–∫—Ç–æ—Ä: —Å—Ç—Ä–æ–∫–∞ ${maxRow + 1} –∏ —Å—Ç–æ–ª–±–µ—Ü ${maxCol + 1} —Å–æ–¥–µ—Ä–∂–∞—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –º–∏–Ω`);
        }
        
        function useChameleon() {
            const config = CONFIG[gameState.mode] || CONFIG.novice;
            
            for (let row = 0; row < config.rows; row++) {
                for (let col = 0; col < config.cols; col++) {
                    if (!gameState.revealed[row][col] && !gameState.flagged[row][col]) {
                        const cell = document.querySelector(`.cell[data-row="${row}"][data-col="${col}"]`);
                        cell.classList.add('chameleon');
                        
                        setTimeout(() => {
                            cell.classList.remove('chameleon');
                        }, 10000);
                    }
                }
            }
            
            showMessage('–•–∞–º–µ–ª–µ–æ–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –ö–ª–µ—Ç–∫–∏ –º–µ–Ω—è—é—Ç —Ü–≤–µ—Ç –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏');
        }
        
        // ========== –¢–ï–ú–´ ==========
        function changeTheme(theme) {
            gameState.theme = theme;
            
            document.body.className = '';
            document.body.classList.add(`${theme}-theme`);
            
            const garlands = document.querySelectorAll('.garland');
            garlands.forEach(g => {
                g.style.display = theme === 'christmas' ? 'block' : 'none';
            });
            
            const smileyBtn = document.getElementById('smiley');
            if (theme === 'halloween') {
                smileyBtn.textContent = '';
                smileyBtn.classList.add('halloween-smiley');
            } else if (theme === 'christmas') {
                smileyBtn.textContent = '';
                smileyBtn.classList.add('christmas-smiley');
            } else {
                smileyBtn.classList.remove('halloween-smiley', 'christmas-smiley');
                smileyBtn.textContent = gameState.gameWon ? 'üòé' : gameState.gameOver ? 'üòµ' : 'üôÇ';
            }
            
            localStorage.setItem('minesweeper-theme', theme);
        }
        
        // ========== –†–ï–ñ–ò–ú–´ ==========
        function changeMode(mode) {
            if (mode === 'tournament' || mode === 'timeless') {
                return;
            }
            
            gameState.mode = mode;
            
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });
            
            initGame();
        }
        
        // ========== –°–û–•–†–ê–ù–ï–ù–ò–ï –ò –ó–ê–ì–†–£–ó–ö–ê ==========
        function saveGameData() {
            localStorage.setItem('minesweeper-stats', JSON.stringify(gameState.stats));
            localStorage.setItem('minesweeper-bonuses', JSON.stringify(gameState.playerBonuses));
            localStorage.setItem('minesweeper-achievements', JSON.stringify(gameState.stats.achievements));
            localStorage.setItem('minesweeper-coins', gameState.coins.toString());
            localStorage.setItem('minesweeper-daily', JSON.stringify({
                quests: gameState.dailyQuests,
                lastReset: gameState.lastDailyReset
            }));
            localStorage.setItem('minesweeper-sound', JSON.stringify({
                enabled: gameState.soundEnabled,
                volume: gameState.soundVolume
            }));
        }
        
        function loadGameData() {
            const stats = localStorage.getItem('minesweeper-stats');
            const bonuses = localStorage.getItem('minesweeper-bonuses');
            const achievements = localStorage.getItem('minesweeper-achievements');
            const coins = localStorage.getItem('minesweeper-coins');
            const daily = localStorage.getItem('minesweeper-daily');
            const theme = localStorage.getItem('minesweeper-theme');
            const sound = localStorage.getItem('minesweeper-sound');
            
            if (stats) gameState.stats = JSON.parse(stats);
            if (bonuses) gameState.playerBonuses = JSON.parse(bonuses);
            if (achievements) {
                gameState.stats.achievements = JSON.parse(achievements);
                ACHIEVEMENTS.forEach(a => {
                    a.unlocked = gameState.stats.achievements.includes(a.id);
                });
            }
            if (coins) gameState.coins = parseInt(coins);
            if (daily) {
                const dailyData = JSON.parse(daily);
                gameState.dailyQuests = dailyData.quests;
                gameState.lastDailyReset = dailyData.lastReset;
            }
            if (theme) changeTheme(theme);
            if (sound) {
                const soundData = JSON.parse(sound);
                gameState.soundEnabled = soundData.enabled;
                gameState.soundVolume = soundData.volume;
            }
        }
        
        // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ò–°–ü–õ–ï–ï–í ==========
        function updatePerfectionDisplay() {
            const fill = document.getElementById('perfection-fill');
            const text = document.getElementById('perfection-text');
            
            fill.style.width = `${gameState.perfection}%`;
            text.textContent = `–ò–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å: ${Math.round(gameState.perfection)}%`;
            document.getElementById('stat-perfection').textContent = `${Math.round(gameState.perfection)}%`;
        }
        
        function updateTimeDisplay() {
            document.getElementById('time-counter').textContent = 
                gameState.seconds.toString().padStart(3, '0');
        }
        
        // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        function showMessage(text) {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #000080;
                color: white;
                padding: 10px 15px;
                border-radius: 5px;
                z-index: 10000;
                font-size: 12px;
                box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
                animation: slideIn 0.3s ease;
            `;
            message.textContent = text;
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => message.remove(), 300);
            }, 3000);
        }
        
        function showResults() {
            const config = gameState.mode === 'hardcore' ? 
                { ...CONFIG.expert, mines: Math.floor(CONFIG.expert.mines * 2) } : 
                CONFIG[gameState.mode] || CONFIG.novice;
            
            const perfection = Math.round(gameState.perfection);
            
            let resultHTML = `
                <div style="text-align: center; margin-bottom: 20px;">
                    <h2 style="color: ${gameState.gameWon ? '#008000' : '#ff0000'}; margin-bottom: 10px;">
                        ${gameState.gameWon ? 'üéâ –ü–û–ë–ï–î–ê! üéâ' : 'üí• –ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê üí•'}
                    </h2>
                    <div style="font-size: 14px; margin-bottom: 5px;">
                        –ò–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å: <strong style="color: ${perfection >= 80 ? '#008000' : perfection >= 50 ? '#ff9900' : '#ff0000'}">${perfection}%</strong>
                    </div>
                </div>
                
                <div style="background-color: #e0e0e0; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 12px;">
                        <div><strong>–í—Ä–µ–º—è:</strong> ${gameState.seconds} —Å–µ–∫</div>
                        <div><strong>–†–µ–∂–∏–º:</strong> ${config.name}</div>
                        <div><strong>–û—Ç–∫—Ä—ã—Ç–æ –∫–ª–µ—Ç–æ–∫:</strong> ${gameState.revealed.flat().filter(Boolean).length}</div>
                        <div><strong>–ù–∞–π–¥–µ–Ω–æ –º–∏–Ω:</strong> ${gameState.minesFound}/${config.mines}</div>
                        <div><strong>–í–∑–æ—Ä–≤–∞–Ω–æ –º–∏–Ω:</strong> ${gameState.minesExploded}</div>
                        <div><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –æ—Ç–º–µ–Ω:</strong> ${3 - gameState.undosLeft}</div>
                        <div><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–æ–¥—Å–∫–∞–∑–æ–∫:</strong> ${3 - gameState.hintsLeft}</div>
                    </div>
                </div>
            `;
            
            if (gameState.gameWon) {
                const coinsEarned = Math.floor((perfection / 10) * config.multiplier);
                resultHTML += `
                    <div style="background-color: #ffffcc; padding: 10px; border-radius: 5px; margin-bottom: 15px;">
                        <strong>–ù–∞–≥—Ä–∞–¥–∞:</strong><br>
                        ${coinsEarned} ü™ô –º–æ–Ω–µ—Ç (${perfection}% –∏–¥–µ–∞–ª—å–Ω–æ—Å—Ç—å √ó ${config.multiplier}x –º–Ω–æ–∂–∏—Ç–µ–ª—å)
                    </div>
                `;
            }
            
            document.getElementById('results-content').innerHTML = resultHTML;
            document.getElementById('results-modal').classList.add('active');
        }
        
        // ========== –°–ë–†–û–° –ü–†–û–ì–†–ï–°–°–ê ==========
        function resetProgress() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                localStorage.clear();
                gameState = {
                    board: [],
                    mines: [],
                    revealed: [],
                    flagged: [],
                    gameOver: false,
                    gameWon: false,
                    firstClick: true,
                    timer: null,
                    seconds: 0,
                    mode: 'normal',
                    theme: 'classic',
                    perfection: 100,
                    minesExploded: 0,
                    minesFound: 0,
                    hintsLeft: 3,
                    undosLeft: 3,
                    coins: 0,
                    playerBonuses: {
                        scanner: 0,
                        shield: 0,
                        teleport: 0,
                        magnet: 0,
                        detector: 0,
                        chameleon: 0
                    },
                    stats: {
                        gamesPlayed: 0,
                        gamesWon: 0,
                        bestTime: 999,
                        bestPerfection: 0,
                        totalCoins: 0,
                        achievements: [],
                        perfectGames: 0,
                        totalTime: 0
                    },
                    moveHistory: [],
                    ghosts: [],
                    learningStep: 0,
                    dailyQuests: JSON.parse(JSON.stringify(DAILY_QUESTS)),
                    lastDailyReset: null,
                    language: 'ru',
                    soundEnabled: true,
                    soundVolume: 0.5
                };
                
                // –°–±—Ä–æ—Å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
                ACHIEVEMENTS.forEach(a => a.unlocked = false);
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                location.reload();
            }
        }
        
        // ========== –ù–ê–°–¢–†–û–ô–ö–ê –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í –°–û–ë–´–¢–ò–ô ==========
        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∞ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
            document.getElementById('btn-new').addEventListener('click', initGame);
            document.getElementById('smiley').addEventListener('click', initGame);
            document.getElementById('new-game').addEventListener('click', initGame);
            
            // –ü–æ–¥—Å–∫–∞–∑–∫–∞
            document.getElementById('btn-hint').addEventListener('click', useHint);
            
            // –û—Ç–º–µ–Ω–∞
            document.getElementById('btn-undo').addEventListener('click', undoMove);
            
            // –ê–Ω–∞–ª–∏–∑
            document.getElementById('btn-analyze').addEventListener('click', () => {
                showMessage('–§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!');
            });
            
            // –í–æ–ø—Ä–æ—Å–Ω—ã–µ –æ—Ç–º–µ—Ç–∫–∏
            document.getElementById('btn-marks').addEventListener('click', function() {
                this.classList.toggle('active');
                showMessage(this.classList.contains('active') ? 
                    '–í–æ–ø—Ä–æ—Å–Ω—ã–µ –æ—Ç–º–µ—Ç–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã' : '–í–æ–ø—Ä–æ—Å–Ω—ã–µ –æ—Ç–º–µ—Ç–∫–∏ –≤—ã–∫–ª—é—á–µ–Ω—ã');
            });
            
            // –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
            document.querySelectorAll('.mode-btn:not(.in-dev)').forEach(btn => {
                btn.addEventListener('click', () => changeMode(btn.dataset.mode));
            });
            
            // –í—ã–±–æ—Ä —Ç–µ–º—ã
            document.querySelectorAll('[data-theme]').forEach(item => {
                item.addEventListener('click', () => changeTheme(item.dataset.theme));
            });
            
            // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤
            document.getElementById('use-teleport').addEventListener('click', () => useBonus('teleport'));
            document.getElementById('use-magnet').addEventListener('click', () => useBonus('magnet'));
            document.getElementById('use-detector').addEventListener('click', () => useBonus('detector'));
            document.getElementById('use-chameleon').addEventListener('click', () => useBonus('chameleon'));
            document.getElementById('use-scan').addEventListener('click', () => useBonus('scanner'));
            document.getElementById('use-shield').addEventListener('click', () => useBonus('shield'));
            
            // –ú–∞–≥–∞–∑–∏–Ω
            document.getElementById('shop').addEventListener('click', showShopModal);
            
            // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
            document.getElementById('daily-challenge').addEventListener('click', () => {
                const modal = document.getElementById('daily-modal');
                const content = document.getElementById('daily-content');
                
                let html = '<div style="max-height: 400px; overflow-y: auto;">';
                gameState.dailyQuests.forEach(quest => {
                    html += `
                        <div class="daily-quest ${quest.completed ? 'quest-completed' : ''}">
                            <div style="font-weight: bold; font-size: 12px;">${quest.name}</div>
                            <div style="font-size: 10px; margin-bottom: 5px;">${quest.desc}</div>
                            <div style="color: gold; font-weight: bold;">
                                –ù–∞–≥—Ä–∞–¥–∞: ${quest.reward} ü™ô
                                ${quest.completed ? '<span style="color: green; margin-left: 10px;">‚úì –í—ã–ø–æ–ª–Ω–µ–Ω–æ</span>' : ''}
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                content.innerHTML = html;
                modal.classList.add('active');
            });
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            document.getElementById('achievements').addEventListener('click', () => {
                showAchievementsModal();
            });
            
            // –û–±—É—á–µ–Ω–∏–µ
            document.getElementById('tutorial').addEventListener('click', () => {
                changeMode('learning');
            });
            
            // –ó–≤—É–∫
            document.getElementById('sound-toggle').addEventListener('click', () => {
                SoundManager.toggle();
            });
            
            document.getElementById('sound-volume-up').addEventListener('click', () => {
                SoundManager.volumeUp();
            });
            
            document.getElementById('sound-volume-down').addEventListener('click', () => {
                SoundManager.volumeDown();
            });
            
            // –°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            document.getElementById('reset-progress').addEventListener('click', resetProgress);
            
            // –û—Å–æ–±—ã–π —Ä–µ–∂–∏–º
            document.getElementById('custom-mode').addEventListener('click', () => {
                showMessage('–û—Å–æ–±—ã–π —Ä–µ–∂–∏–º –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!');
            });
            
            // –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
            document.getElementById('close-btn').addEventListener('click', () => {
                document.getElementById('exit-modal').classList.add('active');
            });
            
            document.getElementById('exit-cancel').addEventListener('click', () => {
                document.getElementById('exit-modal').classList.remove('active');
            });
            
            document.getElementById('exit-confirm').addEventListener('click', () => {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–æ –±—ã –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞
                showMessage('–®—É—Ç–∫–∞! –ò–≥—Ä–∞ –æ—Å—Ç–∞–ª–∞—Å—å –æ—Ç–∫—Ä—ã—Ç–æ–π üòä');
                document.getElementById('exit-modal').classList.remove('active');
            });
            
            // Dev Console (Ctrl+Shift+C)
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                    showDevConsole();
                }
                
                // Dev Console –∫–æ–º–∞–Ω–¥—ã –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Enter
                if (e.key === 'Enter' && document.getElementById('devconsole-modal').classList.contains('active')) {
                    const input = document.getElementById('devconsole-input');
                    if (input.value.trim()) {
                        executeDevCommand(input.value.trim());
                        input.value = '';
                    }
                }
            });
            
            // Dev Console –∫–Ω–æ–ø–∫–∏
            document.getElementById('devconsole-execute').addEventListener('click', () => {
                const input = document.getElementById('devconsole-input');
                if (input.value.trim()) {
                    executeDevCommand(input.value.trim());
                    input.value = '';
                }
            });
            
            document.getElementById('devconsole-clear').addEventListener('click', () => {
                document.getElementById('devconsole-output').innerHTML = '';
            });
            
            document.getElementById('close-devconsole').addEventListener('click', () => {
                document.getElementById('devconsole-modal').classList.remove('active');
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            document.querySelectorAll('.control-btn[id^="close-"]').forEach(btn => {
                if (btn.id !== 'close-btn') {
                    btn.addEventListener('click', function() {
                        this.closest('.xp-modal').classList.remove('active');
                    });
                }
            });
            
            document.getElementById('play-again').addEventListener('click', () => {
                document.getElementById('results-modal').classList.remove('active');
                initGame();
            });
            
            // –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏–∑ –º–µ–Ω—é
            document.querySelectorAll('[data-mode]').forEach(item => {
                item.addEventListener('click', (e) => {
                    const mode = e.target.dataset.mode;
                    if (mode === 'tournament' || mode === 'timeless') {
                        showMessage('–≠—Ç–æ—Ç —Ä–µ–∂–∏–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!');
                        return;
                    }
                    changeMode(mode);
                });
            });
            
            // –û–±—É—á–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
            if (!localStorage.getItem('minesweeper-first-run')) {
                setTimeout(() => {
                    changeMode('learning');
                    localStorage.setItem('minesweeper-first-run', 'true');
                }, 1000);
            }
        }
        
        function showAchievementsModal() {
            const modal = document.getElementById('achievements-modal');
            const content = document.getElementById('achievements-content');
            
            let html = '<div style="max-height: 400px; overflow-y: auto;">';
            
            ACHIEVEMENTS.forEach(achievement => {
                if (achievement.secret && !achievement.unlocked) {
                    html += `
                        <div class="achievement">
                            <div class="achievement-icon">‚ùì</div>
                            <div class="achievement-info">
                                <div class="achievement-name">–°–µ–∫—Ä–µ—Ç–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ</div>
                                <div class="achievement-desc">–†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å</div>
                            </div>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="achievement ${achievement.unlocked ? 'unlocked' : ''}">
                            <div class="achievement-icon">${achievement.icon}</div>
                            <div class="achievement-info">
                                <div class="achievement-name">${achievement.name}</div>
                                <div class="achievement-desc">${achievement.desc}</div>
                            </div>
                        </div>
                    `;
                }
            });
            
            html += '</div>';
            content.innerHTML = html;
            modal.classList.add('active');
        }
        
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï ==========
        document.addEventListener('DOMContentLoaded', function() {
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
            document.getElementById('btn-ru').addEventListener('click', function() {
                selectLanguage('ru');
            });
            
            document.getElementById('btn-en').addEventListener('click', function() {
                selectLanguage('en');
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —É–∂–µ –≤—ã–±—Ä–∞–Ω —è–∑—ã–∫
            const savedLanguage = localStorage.getItem('minesweeper-language');
            if (savedLanguage) {
                selectLanguage(savedLanguage);
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
                document.getElementById('language-modal').style.display = 'flex';
            }
        });
        
        // –°—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>