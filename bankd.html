<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DOROSpay ‚Äî —Ç–≤–æ–π –≥–æ—Ä–æ–¥—Å–∫–æ–π –∫–æ—à–µ–ª—ë–∫</title>
  
  <!-- –ò–∫–æ–Ω–∫–∞ (–ø—Ä–µ–∂–Ω—è—è, –º–æ–∂–Ω–æ —Å–º–µ–Ω–∏—Ç—å –ø–æ–∑–∂–µ) -->
  <link rel="icon" type="image/png" href="https://i.ibb.co/4ndNJYKS/Chat-GPT-Image-14-2025-21-36-48.png">
  
  <!-- –®—Ä–∏—Ñ—Ç—ã –∏ –∏–∫–æ–Ω–∫–∏ -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,300..800&display=swap" rel="stylesheet">
  
  <!-- QR-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –µ—Å—Ç—å) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
  
  <style>
    /* ------------------------------------------------------
       –ù–û–í–´–ô –î–ò–ó–ê–ô–ù DOROSpay ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–æ
       –¶–≤–µ—Ç–∞: —Ç—ë–º–Ω–æ-—Å–∏–Ω–∏–π + –∞–∫–≤–∞–º–∞—Ä–∏–Ω + –±–µ–ª—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
    ------------------------------------------------------ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-dark: #0b1120;
      --bg-card: #1e293b;
      --surface: #ffffff;
      --primary: #14b8a6;
      --primary-dark: #0f766e;
      --accent: #f97316;
      --text-light: #f1f5f9;
      --text-muted: #94a3b8;
      --text-dark: #0f172a;
      --danger: #ef4444;
      --success: #22c55e;
      --radius-card: 32px;
      --radius-btn: 999px;
      --shadow-heavy: 0 25px 50px -12px rgba(0,0,0,0.5);
      --transition: all 0.2s ease;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-dark);
      color: var(--text-light);
      min-height: 100vh;
      line-height: 1.5;
    }

    /* —Å–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
    .hidden { display: none !important; }

    /* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 24px;
    }

    /* ------ –≠–ö–†–ê–ù –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò (–ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤—ã–π –≤–∏–¥) ------ */
    #auth-screen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at 10% 30%, #1e293b, #0b1120);
      padding: 20px;
    }

    .auth-card {
      background: rgba(30, 41, 59, 0.8);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 48px;
      padding: 48px 32px;
      width: 100%;
      max-width: 460px;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: var(--shadow-heavy);
    }

    .auth-logo {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      margin-bottom: 32px;
    }
    .auth-logo img {
      width: 48px;
      height: 48px;
      border-radius: 16px;
    }
    .auth-logo span {
      font-size: 28px;
      font-weight: 700;
      background: linear-gradient(135deg, #fff, #94a3b8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .auth-tabs {
      display: flex;
      gap: 8px;
      background: #1e293b;
      padding: 6px;
      border-radius: 60px;
      margin-bottom: 32px;
    }
    .auth-tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      font-weight: 600;
      border-radius: 40px;
      cursor: pointer;
      transition: var(--transition);
      color: var(--text-muted);
    }
    .auth-tab.active {
      background: var(--primary);
      color: black;
    }

    .auth-input {
      width: 100%;
      padding: 16px 20px;
      background: #0f172a;
      border: 1px solid #334155;
      border-radius: 40px;
      font-size: 16px;
      color: white;
      margin-bottom: 16px;
    }
    .auth-input:focus {
      outline: none;
      border-color: var(--primary);
    }

    .auth-btn {
      width: 100%;
      padding: 16px;
      background: var(--primary);
      border: none;
      border-radius: 40px;
      font-weight: 700;
      font-size: 16px;
      color: black;
      margin: 8px 0 16px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .auth-btn:hover {
      background: var(--primary-dark);
    }

    /* ------ –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° (–ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞) ------ */
    .app-header {
      background: #1e293b;
      border-bottom: 1px solid #334155;
      padding: 12px 0;
      position: sticky;
      top: 0;
      z-index: 50;
    }
    .header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .logo-doros {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .logo-doros img {
      width: 36px;
      height: 36px;
      border-radius: 10px;
    }
    .logo-doros span {
      font-weight: 700;
      font-size: 20px;
      color: white;
    }
    .user-menu {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .user-name {
      color: var(--text-light);
      font-weight: 500;
    }
    .admin-badge {
      background: var(--accent);
      color: black;
      padding: 4px 12px;
      border-radius: 40px;
      font-size: 12px;
      font-weight: 700;
    }
    .logout-btn {
      background: transparent;
      border: 1px solid #475569;
      color: white;
      padding: 8px 16px;
      border-radius: 40px;
      display: flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      transition: var(--transition);
    }
    .logout-btn:hover {
      background: #334155;
    }

    /* –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å–Ω–∏–∑—É (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö) + –±–æ–∫–æ–≤–∞—è –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */
    .app-wrapper {
      display: flex;
      flex-direction: row;
      gap: 24px;
      padding: 24px 0;
    }
    .sidebar {
      width: 260px;
      flex-shrink: 0;
    }
    .nav-menu {
      background: #1e293b;
      border-radius: 32px;
      padding: 24px 8px;
      position: sticky;
      top: 90px;
    }
    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 20px;
      margin: 4px 0;
      border-radius: 40px;
      color: var(--text-muted);
      transition: var(--transition);
      cursor: pointer;
    }
    .nav-item:hover, .nav-item.active {
      background: #334155;
      color: white;
    }
    .nav-item .material-icons {
      font-size: 24px;
    }

    /* –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
    .main-content {
      flex: 1;
      min-width: 0;
    }

    /* –∫–∞—Ä—Ç–æ—á–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (–≤–∏–¥–∂–µ—Ç) */
    .balance-widget {
      background: linear-gradient(145deg, #1e293b, #0f172a);
      border-radius: 32px;
      padding: 24px 32px;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      border: 1px solid #334155;
    }
    .balance-info h3 {
      color: var(--text-muted);
      font-weight: 400;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .balance-amount {
      font-size: 42px;
      font-weight: 700;
      color: white;
      line-height: 1.2;
    }
    .active-card-badge {
      background: var(--primary);
      color: black;
      padding: 4px 12px;
      border-radius: 40px;
      font-size: 13px;
      font-weight: 600;
      margin-left: 12px;
    }
    .balance-actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    .btn-round {
      background: #334155;
      border: none;
      color: white;
      padding: 14px 24px;
      border-radius: 60px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: var(--transition);
    }
    .btn-round.primary {
      background: var(--primary);
      color: black;
    }
    .btn-round:hover {
      background: #475569;
    }
    .btn-round.primary:hover {
      background: var(--primary-dark);
    }

    /* —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∞ (–Ω–æ–≤—ã–π –¥–∏–∑–∞–π–Ω) */
    .card-preview {
      background: linear-gradient(145deg, #2d3b52, #1e293b);
      border-radius: 24px;
      padding: 20px 24px;
      margin-bottom: 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      border: 1px solid #4b5563;
      box-shadow: 0 10px 30px -10px black;
    }
    .card-preview-left {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .card-type {
      color: var(--text-muted);
      font-size: 13px;
      letter-spacing: 1px;
    }
    .card-number {
      font-family: 'Courier New', monospace;
      font-size: 20px;
      font-weight: 600;
      letter-spacing: 2px;
      color: white;
    }
    .card-holder {
      font-size: 14px;
      color: #cbd5e1;
    }
    .card-expiry {
      color: #cbd5e1;
      font-size: 14px;
    }

    /* —Å–µ—Ç–∫–∏ –±—ã—Å—Ç—Ä—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π */
    .quick-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 32px;
    }
    .quick-item {
      background: #1e293b;
      border-radius: 24px;
      padding: 20px 12px;
      text-align: center;
      transition: var(--transition);
      cursor: pointer;
      border: 1px solid #334155;
    }
    .quick-item:hover {
      background: #2d3b52;
      transform: translateY(-4px);
    }
    .quick-item .material-icons {
      font-size: 32px;
      color: var(--primary);
      margin-bottom: 8px;
    }
    .quick-item span:last-child {
      font-weight: 500;
    }

    /* –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ */
    .section-card {
      background: #1e293b;
      border-radius: 32px;
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid #334155;
    }
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .section-header h2 {
      font-size: 20px;
      font-weight: 600;
    }

    /* —Å–µ—Ç–∫–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∫–∞—Ä—Ç */
    .card-shop-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }
    .shop-item {
      background: #0f172a;
      border-radius: 28px;
      padding: 24px 16px;
      text-align: center;
      border: 1px solid #334155;
      transition: var(--transition);
    }
    .shop-item.debit { border-top: 4px solid #14b8a6; }
    .shop-item.gold { border-top: 4px solid #fbbf24; }
    .shop-item.platinum { border-top: 4px solid #94a3b8; }
    .shop-item .material-icons {
      font-size: 48px;
      color: var(--primary);
    }
    .shop-item .card-price {
      font-size: 28px;
      font-weight: 700;
      margin: 16px 0;
    }
    .shop-features {
      list-style: none;
      margin: 16px 0;
    }
    .shop-features li {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #334155;
    }
    .btn-shop {
      background: transparent;
      border: 1px solid var(--primary);
      color: white;
      padding: 12px;
      border-radius: 60px;
      font-weight: 600;
      width: 100%;
      cursor: pointer;
      transition: var(--transition);
    }
    .btn-shop:hover {
      background: var(--primary);
      color: black;
    }

    /* –∫—Ä–µ–¥–∏—Ç–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä */
    .credit-calc {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-muted);
    }
    .form-control {
      width: 100%;
      padding: 14px 20px;
      background: #0f172a;
      border: 1px solid #334155;
      border-radius: 40px;
      color: white;
    }

    /* QR-–±–ª–æ–∫ */
    .qr-panel {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }
    #qrcode-display canvas {
      border-radius: 24px;
      background: white;
      padding: 8px;
    }

    /* –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (–Ω–æ–≤—ã–π —Å—Ç–∏–ª—å) */
    .modal {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 16px;
    }
    .modal-content {
      background: #1e293b;
      border-radius: 48px;
      padding: 32px;
      width: 100%;
      max-width: 500px;
      border: 1px solid #4b5563;
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }
    .modal-header h3 {
      font-size: 24px;
    }
    .modal-close {
      background: none;
      border: none;
      color: white;
      font-size: 28px;
      cursor: pointer;
    }
    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 16px;
      margin-top: 24px;
    }

    /* —Å—Ç–∞—Ä—ã–µ –∫–Ω–æ–ø–∫–∏ —Å–ø—Ä–∞–≤–∞ (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã, —á—É—Ç—å –æ—Å–≤–µ–∂–µ–Ω—ã) */
    .action-buttons {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      z-index: 9999;
    }
    .action-btn {
      width: 65px; height: 65px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      color: white; border: none; cursor: pointer;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
      position: relative;
    }
    .action-btn:hover { transform: scale(1.15) translateY(-5px); }
    .tooltip {
      position: absolute; right: 80px; background: #0f172a;
      color: white; padding: 10px 20px; border-radius: 40px;
      font-size: 14px; white-space: nowrap; opacity: 0;
      pointer-events: none; transition: opacity 0.3s ease;
      border: 1px solid #334155;
    }
    .action-btn:hover .tooltip { opacity: 1; }
    .btn-taxi { background: linear-gradient(145deg, #f97316, #c2410c); }
    .btn-ai { background: linear-gradient(145deg, #a855f7, #7e22ce); }
    .btn-telegram { background: linear-gradient(145deg, #2563eb, #1e3a8a); }
    .btn-call { background: linear-gradient(145deg, #22c55e, #15803d); }
    .btn-shop-action { background: linear-gradient(145deg, #ef4444, #b91c1c); }

    /* –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
    @media (max-width: 900px) {
      .app-wrapper { flex-direction: column; }
      .sidebar { width: 100%; }
      .nav-menu { display: flex; flex-wrap: wrap; gap: 4px; justify-content: center; }
      .nav-item { padding: 10px 16px; }
      .quick-grid { grid-template-columns: repeat(2, 1fr); }
      .card-shop-grid { grid-template-columns: 1fr; }
      .credit-calc { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <!-- ===== –ö–ù–û–ü–ö–ò –°–ü–†–ê–í–ê (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô, –¢–û–õ–¨–ö–û –ö–û–°–ú–ï–¢–ò–ö–ê) ===== -->
  <div class="action-buttons">
    <button class="action-btn btn-taxi" onclick="window.open('https://famd-sn.github.io/Muzaffar-/taxi.html', '_blank')" title="–¢–∞–∫—Å–∏">
      <span class="material-icons">local_taxi</span>
      <span class="tooltip">–ó–∞–∫–∞–∑–∞—Ç—å —Ç–∞–∫—Å–∏</span>
    </button>
    <button class="action-btn btn-ai" onclick="window.open('https://–≤–∞—à–∞-—Å—Å—ã–ª–∫–∞-–Ω–∞-ai.com', '_blank')" title="AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç">
      <span class="material-icons">smart_toy</span>
      <span class="tooltip">AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</span>
    </button>
    <button class="action-btn btn-shop-action" onclick="window.open('file:///C:/Users/User/Desktop/ijg.html#', '_blank')" title="–ú–∞–≥–∞–∑–∏–Ω">
      <span class="material-icons">shopping_cart</span>
      <span class="tooltip">–ü–µ—Ä–µ–π—Ç–∏ –≤ –º–∞–≥–∞–∑–∏–Ω</span>
    </button>
    <a href="https://t.me/fgvvn2" target="_blank" class="action-btn btn-telegram" title="Telegram">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" fill="white"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.224-.536.224l.213-3.053 5.56-5.022c.241-.213-.054-.334-.373-.121l-6.869 4.326-2.962-.924c-.643-.203-.658-.643.136-.953l11.57-4.461c.538-.196 1.006.128.832.941z"/></svg>
      <span class="tooltip">–ù–∞–ø–∏—Å–∞—Ç—å –≤ Telegram</span>
    </a>
    <button class="action-btn btn-call" onclick="window.location.href='tel:+992926310060'" title="–ü–æ–∑–≤–æ–Ω–∏—Ç—å">
      <span class="material-icons">call</span>
      <span class="tooltip">–ü–æ–∑–≤–æ–Ω–∏—Ç—å</span>
    </button>
  </div>

  <!-- ===== –≠–ö–†–ê–ù –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ===== -->
  <div id="auth-screen">
    <div class="auth-card">
      <div class="auth-logo">
        <img src="https://i.ibb.co/4ndNJYKS/Chat-GPT-Image-14-2025-21-36-48.png" alt="DOROSpay">
        <span>DOROSpay</span>
      </div>
      <div class="auth-tabs">
        <div class="auth-tab active" id="tab-login">–í—Ö–æ–¥</div>
        <div class="auth-tab" id="tab-reg">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
      </div>
      
      <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
      <div id="login-form">
        <input type="email" id="login-email" class="auth-input" placeholder="–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞">
        <input type="password" id="login-password" class="auth-input" placeholder="–ü–∞—Ä–æ–ª—å">
        <button id="login-btn" class="auth-btn"><span class="material-icons">login</span> –í–æ–π—Ç–∏</button>
        <p style="text-align:center; color:var(--text-muted);">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="show-register" style="color:var(--primary);">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
      </div>
      
      <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (—Å–∫—Ä—ã—Ç–∞) -->
      <div id="register-form" style="display:none;">
        <input type="text" id="register-fullname" class="auth-input" placeholder="–ü–æ–ª–Ω–æ–µ –∏–º—è">
        <input type="tel" id="register-phone" class="auth-input" placeholder="+992 00 000 0000">
        <input type="email" id="register-email" class="auth-input" placeholder="–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞">
        <input type="password" id="register-password" class="auth-input" placeholder="–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)">
        <button id="register-btn" class="auth-btn"><span class="material-icons">person_add</span> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        <p style="text-align:center; color:var(--text-muted);">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" id="show-login" style="color:var(--primary);">–í–æ–π—Ç–∏</a></p>
      </div>
      <div id="auth-message" class="alert hidden" style="margin-top:16px;"></div>
    </div>
  </div>

  <!-- ===== –û–°–ù–û–í–ù–û–ô –≠–ö–†–ê–ù DOROSpay ===== -->
  <div id="bank-screen" class="hidden">
    <header class="app-header">
      <div class="container header-row">
        <div class="header-left">
          <div class="logo-doros">
            <img src="https://i.ibb.co/4ndNJYKS/Chat-GPT-Image-14-2025-21-36-48.png" alt="DOROSpay">
            <span>DOROSpay</span>
          </div>
        </div>
        <div class="user-menu">
          <span class="user-name" id="user-display-name"></span>
          <span id="admin-badge" class="admin-badge hidden">–ê–î–ú–ò–ù</span>
          <button id="logout-btn" class="logout-btn"><span class="material-icons">logout</span> –í—ã–π—Ç–∏</button>
        </div>
      </div>
    </header>

    <div class="container app-wrapper">
      <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é (–Ω–∞–≤–∏–≥–∞—Ü–∏—è) -->
      <aside class="sidebar">
        <div class="nav-menu">
          <div class="nav-item active" data-tab="dashboard"><span class="material-icons">home</span> –ì–ª–∞–≤–Ω–∞—è</div>
          <div class="nav-item" data-tab="my-cards"><span class="material-icons">credit_card</span> –ú–æ–∏ –∫–∞—Ä—Ç—ã</div>
          <div class="nav-item" data-tab="buy-cards"><span class="material-icons">shopping_bag</span> –ö—É–ø–∏—Ç—å –∫–∞—Ä—Ç—É</div>
          <div class="nav-item" data-tab="credits"><span class="material-icons">account_balance</span> –ö—Ä–µ–¥–∏—Ç—ã</div>
          <div class="nav-item" data-tab="shop"><span class="material-icons">store</span> –ú–∞–≥–∞–∑–∏–Ω</div>
          <div class="nav-item" data-tab="qr-generator"><span class="material-icons">qr_code</span> QR-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä</div>
        </div>
      </aside>

      <!-- –ö–æ–Ω—Ç–µ–Ω—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å -->
      <main class="main-content">
        <!-- DASHBOARD TAB -->
        <div id="dashboard-tab" class="tab-content">
          <!-- –ë–∞–ª–∞–Ω—Å + –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
          <div class="balance-widget">
            <div class="balance-info">
              <h3>–î–æ—Å—Ç—É–ø–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤</h3>
              <div class="balance-amount" id="balance">0 —Å–æ–º.</div>
              <span id="active-card-badge" class="active-card-badge">–û—Å–Ω–æ–≤–Ω–∞—è</span>
            </div>
            <div class="balance-actions">
              <button class="btn-round primary" onclick="document.getElementById('deposit-modal').classList.remove('hidden')"><span class="material-icons">add</span> –ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
              <button class="btn-round" onclick="document.getElementById('transfer-modal').classList.remove('hidden')"><span class="material-icons">send</span> –ü–µ—Ä–µ–≤–µ—Å—Ç–∏</button>
              <button class="btn-round" onclick="showQuickQRCode()"><span class="material-icons">qr_code</span> QR</button>
            </div>
          </div>

          <!-- –ö–∞—Ä—Ç–∞ (–∞–∫—Ç–∏–≤–Ω–∞—è) -->
          <div class="card-preview" id="active-card-display">
            <div class="card-preview-left">
              <span class="card-type" id="active-card-type-label">–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞</span>
              <span class="card-number" id="active-card-number">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢</span>
              <span class="card-holder" id="active-card-name">–ò–ú–Ø –í–õ–ê–î–ï–õ–¨–¶–ê</span>
            </div>
            <div class="card-expiry" id="active-card-expiry">12/28</div>
          </div>

          <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–∏–∫–æ–Ω–∫–∏) -->
          <div class="quick-grid">
            <div class="quick-item" onclick="document.getElementById('deposit-modal').classList.remove('hidden')">
              <span class="material-icons">account_balance</span><span>–ü–æ–ø–æ–ª–Ω–∏—Ç—å</span>
            </div>
            <div class="quick-item" onclick="document.getElementById('transfer-modal').classList.remove('hidden')">
              <span class="material-icons">swap_horiz</span><span>–ü–µ—Ä–µ–≤–µ—Å—Ç–∏</span>
            </div>
            <div class="quick-item" onclick="showQuickQRCode()">
              <span class="material-icons">qr_code_scanner</span><span>–ú–æ–π QR</span>
            </div>
            <div class="quick-item" onclick="showTransactionHistory()">
              <span class="material-icons">history</span><span>–ò—Å—Ç–æ—Ä–∏—è</span>
            </div>
          </div>

          <!-- –ö—Ä–µ–¥–∏—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è -->
          <div class="section-card">
            <div class="section-header">
              <h2>–ö—Ä–µ–¥–∏—Ç—ã</h2>
              <button class="btn-round" style="padding:8px 16px;" onclick="document.querySelector('[data-tab=\'credits\']').click()">–í—Å–µ –∫—Ä–µ–¥–∏—Ç—ã</button>
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
              <div style="background:#0f172a; border-radius:24px; padding:20px;">
                <span style="color:var(--primary);">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∏–π</span>
                <div style="font-size:28px; font-weight:700;">–¥–æ 50 000</div>
                <button class="btn-shop" style="margin-top:12px;" onclick="openCreditModal('consumer')">–û—Ñ–æ—Ä–º–∏—Ç—å</button>
              </div>
              <div style="background:#0f172a; border-radius:24px; padding:20px;">
                <span style="color:var(--primary);">–ë–∏–∑–Ω–µ—Å‚Äë–∫—Ä–µ–¥–∏—Ç</span>
                <div style="font-size:28px; font-weight:700;">–¥–æ 200 000</div>
                <button class="btn-shop" style="margin-top:12px;" onclick="openCreditModal('business')">–û—Ñ–æ—Ä–º–∏—Ç—å</button>
              </div>
            </div>
          </div>

          <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
          <div class="section-card">
            <div class="section-header">
              <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h2>
              <button id="view-all-btn" class="btn-round" style="padding:8px 16px;"><span class="material-icons">list</span> –í—Å–µ</button>
            </div>
            <div id="recent-transactions">
              <div style="text-align:center; padding:32px; color:var(--text-muted);">
                <span class="material-icons" style="font-size:48px;">payments</span>
                <p>–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π</p>
              </div>
            </div>
          </div>
        </div>

        <!-- MY CARDS TAB -->
        <div id="my-cards-tab" class="tab-content hidden">
          <div class="section-card">
            <h2>–ú–æ–∏ –∫–∞—Ä—Ç—ã</h2>
            <div class="cards-container" id="cards-list" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(240px,1fr)); gap:16px; margin:24px 0;"></div>
            <button id="add-card-btn" class="btn-round primary"><span class="material-icons">add</span> –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É</button>
          </div>
        </div>

        <!-- BUY CARDS TAB -->
        <div id="buy-cards-tab" class="tab-content hidden">
          <div class="section-card">
            <h2 style="margin-bottom:24px;">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É</h2>
            <div class="card-shop-grid">
              <div class="shop-item debit">
                <span class="material-icons">credit_card</span>
                <div class="card-price">0 —Å–æ–º.</div>
                <ul class="shop-features"><li>–ö—ç—à–±—ç–∫ 1% <span>1%</span></li><li>–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã <span>‚úì</span></li></ul>
                <button class="btn-shop get-card-btn" data-card-type="debit">–ü–æ–ª—É—á–∏—Ç—å</button>
              </div>
              <div class="shop-item gold">
                <span class="material-icons">star</span>
                <div class="card-price">500 —Å–æ–º.</div>
                <ul class="shop-features"><li>–ö—ç—à–±—ç–∫ 3% <span>3%</span></li><li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7 <span>VIP</span></li><li>–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ <span>$10k</span></li></ul>
                <button class="btn-shop get-card-btn" data-card-type="gold">–ö—É–ø–∏—Ç—å</button>
              </div>
              <div class="shop-item platinum">
                <span class="material-icons">diamond</span>
                <div class="card-price">1000 —Å–æ–º.</div>
                <ul class="shop-features"><li>–ö—ç—à–±—ç–∫ 5% <span>5%</span></li><li>–ú–µ–Ω–µ–¥–∂–µ—Ä <span>Premium</span></li><li>–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ <span>$50k</span></li><li>VIP-–∑–∞–ª—ã <span>Lounge</span></li></ul>
                <button class="btn-shop get-card-btn" data-card-type="platinum">–ö—É–ø–∏—Ç—å</button>
              </div>
            </div>
          </div>
        </div>

        <!-- CREDITS TAB -->
        <div id="credits-tab" class="tab-content hidden">
          <div class="section-card">
            <h2>–ö—Ä–µ–¥–∏—Ç–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h2>
            <div class="credit-calc">
              <div>
                <div class="form-group"><label>–°—É–º–º–∞</label><input type="number" id="credit-amount" class="form-control" value="10000"></div>
                <div class="form-group"><label>–°—Ä–æ–∫ (–º–µ—Å)</label><select id="credit-term" class="form-control"><option value="6">6</option><option value="12" selected>12</option><option value="24">24</option></select></div>
                <div class="form-group"><label>–°—Ç–∞–≤–∫–∞</label><select id="credit-rate" class="form-control"><option value="12">12%</option><option value="10">10%</option></select></div>
                <div style="background:#0f172a; border-radius:24px; padding:16px; margin:16px 0;"><span>–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂: </span><span style="font-weight:700;" id="monthly-payment">0 —Å–æ–º.</span></div>
                <button id="apply-credit-btn" class="btn-round primary" style="width:100%;">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É</button>
              </div>
              <div style="background:#0f172a; border-radius:24px; padding:24px;">
                <h4>–£—Å–ª–æ–≤–∏—è</h4>
                <p>‚úì –ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ –†–¢</p>
                <p>‚úì –í–æ–∑—Ä–∞—Å—Ç –æ—Ç 21 –≥–æ–¥–∞</p>
                <p>‚úì –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –¥–æ—Ö–æ–¥</p>
              </div>
            </div>
          </div>
          <div class="section-card"><h3>–ú–æ–∏ –∫—Ä–µ–¥–∏—Ç—ã</h3><div id="my-credits-list"><p style="padding:24px; text-align:center;">–ù–µ—Ç –∫—Ä–µ–¥–∏—Ç–æ–≤</p></div></div>
        </div>

        <!-- SHOP TAB -->
        <div id="shop-tab" class="tab-content hidden">
          <div class="section-card">
            <h2>–ú–∞–≥–∞–∑–∏–Ω DOROSpay</h2>
            <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px; margin-top:24px;">
              <div style="background:#0f172a; border-radius:28px; padding:24px; text-align:center;">
                <span class="material-icons" style="font-size:48px;color:var(--primary);">smartphone</span>
                <h4>–ó–∞—â–∏—Ç–Ω—ã–π —á–µ—Ö–æ–ª</h4>
                <div style="font-size:24px; font-weight:700; margin:12px 0;">150 —Å–æ–º.</div>
                <button class="btn-shop" onclick="alert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É')">–ö—É–ø–∏—Ç—å</button>
              </div>
              <div style="background:#0f172a; border-radius:28px; padding:24px; text-align:center;">
                <span class="material-icons" style="font-size:48px; color:#fbbf24;">card_giftcard</span>
                <h4>–ü–æ–¥–∞—Ä–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞</h4>
                <div style="font-size:24px; font-weight:700; margin:12px 0;">500 —Å–æ–º.</div>
                <button class="btn-shop" onclick="alert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É')">–ö—É–ø–∏—Ç—å</button>
              </div>
            </div>
          </div>
        </div>

        <!-- QR GENERATOR TAB -->
        <div id="qr-generator-tab" class="tab-content hidden">
          <div class="section-card">
            <h2>QR‚Äë–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä</h2>
            <div style="max-width:400px; margin:24px auto;">
              <div class="form-group"><label>–ö–∞—Ä—Ç–∞</label><select id="qr-card-select" class="form-control"></select></div>
              <div class="form-group"><label>–°—É–º–º–∞ (–æ–ø—Ü.)</label><input type="number" id="qr-amount" class="form-control"></div>
              <button id="generate-qr-btn" class="btn-round primary"><span class="material-icons">qr_code_2</span> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
              <div id="qr-code-result" style="display:none; margin-top:24px; text-align:center;">
                <div id="qrcode-display"></div>
                <div id="qr-display-card-number" style="margin-top:12px;"></div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê (–Ω–æ–≤—ã–π –¥–∏–∑–∞–π–Ω, ID —Å—Ç–∞—Ä—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã) -->
  <div id="deposit-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h3>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</h3><button class="modal-close">&times;</button></div>
      <div class="modal-body">
        <div class="form-group"><label>–°—É–º–º–∞</label><input type="number" id="deposit-amount" class="form-control"></div>
        <div class="form-group"><label>PIN</label><input type="password" id="deposit-pin" class="form-control" maxlength="4"></div>
        <div id="deposit-message" class="alert hidden"></div>
      </div>
      <div class="modal-footer"><button class="btn-round close-modal">–û—Ç–º–µ–Ω–∞</button><button id="confirm-deposit" class="btn-round primary">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button></div>
    </div>
  </div>

  <div id="transfer-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h3>–ü–µ—Ä–µ–≤–æ–¥</h3><button class="modal-close">&times;</button></div>
      <div class="modal-body">
        <div class="form-group"><label>–ö–∞—Ä—Ç–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</label><input type="text" id="recipient-card" class="form-control" placeholder="0000 0000 0000 0000"></div>
        <div class="form-group"><label>–°—É–º–º–∞</label><input type="number" id="transfer-amount" class="form-control"></div>
        <div class="form-group"><label>PIN</label><input type="password" id="transfer-pin" class="form-control" maxlength="4"></div>
        <div id="transfer-message" class="alert hidden"></div>
      </div>
      <div class="modal-footer"><button class="btn-round close-modal">–û—Ç–º–µ–Ω–∞</button><button id="confirm-transfer" class="btn-round primary">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏</button></div>
    </div>
  </div>

  <div id="add-card-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h3>–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É</h3><button class="modal-close">&times;</button></div>
      <div class="modal-body">
        <div class="form-group"><label>–¢–∏–ø</label><select id="new-card-type" class="form-control"><option value="debit">–î–µ–±–µ—Ç–æ–≤–∞—è (0 —Å–æ–º.)</option><option value="gold">Gold (500 —Å–æ–º.)</option><option value="platinum">Platinum (1000 —Å–æ–º.)</option></select></div>
        <div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" id="new-card-name" class="form-control" placeholder="–ú–æ—è –∫–∞—Ä—Ç–∞"></div>
        <div id="add-card-message" class="alert hidden"></div>
      </div>
      <div class="modal-footer"><button class="btn-round close-modal">–û—Ç–º–µ–Ω–∞</button><button id="confirm-add-card" class="btn-round primary">–î–æ–±–∞–≤–∏—Ç—å</button></div>
    </div>
  </div>

  <div id="credit-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h3>–ó–∞—è–≤–∫–∞ –Ω–∞ –∫—Ä–µ–¥–∏—Ç</h3><button class="modal-close">&times;</button></div>
      <div class="modal-body">
        <div class="form-group"><label>–°—É–º–º–∞</label><input type="number" id="credit-modal-amount" class="form-control" value="10000"></div>
        <div class="form-group"><label>–°—Ä–æ–∫ (–º–µ—Å.)</label><select id="credit-modal-term" class="form-control"><option value="6">6</option><option value="12">12</option><option value="24">24</option></select></div>
        <div id="credit-modal-message" class="alert hidden"></div>
      </div>
      <div class="modal-footer"><button class="btn-round close-modal">–û—Ç–º–µ–Ω–∞</button><button id="confirm-credit-btn" class="btn-round primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button></div>
    </div>
  </div>

  <div id="qr-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header"><h3>–ú–æ–π QR-–∫–æ–¥</h3><button class="modal-close">&times;</button></div>
      <div class="modal-body" style="text-align:center;">
        <div id="qrcode-modal"></div>
        <div id="qr-modal-card-number" style="margin-top:16px;"></div>
      </div>
    </div>
  </div>

  <!-- –°–ö–†–ò–ü–¢ (–ü–û–õ–ù–û–°–¢–¨–Æ –û–†–ò–ì–ò–ù–ê–õ–¨–ù–´–ô, –ù–ò –°–¢–†–û–ß–ö–ò –ù–ï –ò–ó–ú–ï–ù–ï–ù–û, –ö–†–û–ú–ï –ù–ê–ó–í–ê–ù–ò–Ø –í TELEGRAM) -->
  <script>
    // ==============================================
    // MUZAFFAR BANK - –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–ß–ê–Ø –í–ï–†–°–ò–Ø (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ DOROSpay –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ª–æ–≥–∏–∫–∏)
    // Telegram: 8031233615:AAGgZKmnpg27rBG351r4MslVg3Psi8Uykts
    // Chat ID: 5450527103
    // ==============================================
    
    const TELEGRAM_BOT_TOKEN = '8031233615:AAGgZKmnpg27rBG351r4MslVg3Psi8Uykts';
    const TELEGRAM_CHAT_ID = '5450527103';
    const ADMIN_EMAIL = "admin@muzaffar.tj";
    const ADMIN_PASSWORD = "Admin123!";
    const ADMIN_CARD_NUMBER = "4111 1111 1111 1111";

    const CARD_TYPES = {
      debit: { name: "–î–µ–±–µ—Ç–æ–≤–∞—è", price: 0 },
      gold: { name: "Gold", price: 500 },
      platinum: { name: "Platinum", price: 1000 }
    };

    let currentUser = null;
    let userCards = [];
    let userTransactions = [];
    let userCredits = [];
    let activeCardIndex = 0;

    async function sendTelegramMessage(message) {
      try {
        const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
        await fetch(url, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text: message, parse_mode: 'HTML' })
        });
      } catch (error) { console.log("Telegram:", message); }
    }

    function initApp() {
      console.log("DOROSpay START");
      if (!localStorage.getItem('adminCreated')) {
        createAdminAccount();
        localStorage.setItem('adminCreated', 'true');
      }
      const savedUser = localStorage.getItem('currentUser');
      if (savedUser) {
        currentUser = JSON.parse(savedUser);
        loadUserData();
        showBankScreen();
      }
      setupEventListeners();
      initCreditCalculator();
    }

    function createAdminAccount() {
      const adminCards = [{
        id: 'admin-card-1',
        type: 'platinum',
        number: ADMIN_CARD_NUMBER,
        name: 'Platinum –ê–¥–º–∏–Ω–∞',
        balance: 999999999,
        isPrimary: true,
        pin: '0000',
        expiry: '12/99'
      }];
      const adminData = {
        email: ADMIN_EMAIL,
        password: ADMIN_PASSWORD,
        isAdmin: true,
        fullName: "–®–∞—Ä–∏–ø–æ–≤ –ú—É–∑–∞—Ñ—Ñ–∞—Ä –ê–Ω–≤–∞—Ä–æ–≤–∏—á",
        phone: "+992 92 631 0060",
        cards: adminCards,
        transactions: [],
        credits: []
      };
      localStorage.setItem(ADMIN_EMAIL, JSON.stringify(adminData));
    }

    function handleLogin() {
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const message = document.getElementById('auth-message');
      if (!email || !password) { showMessage(message, "–í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å", false); return; }
      if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
        currentUser = { email: ADMIN_EMAIL };
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        loadUserData();
        showBankScreen();
        showMessage(message, "–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω", true);
        return;
      }
      const userData = localStorage.getItem(email);
      if (userData) {
        const user = JSON.parse(userData);
        if (user.password === password) {
          currentUser = { email };
          localStorage.setItem('currentUser', JSON.stringify(currentUser));
          loadUserData();
          showBankScreen();
          showMessage(message, "–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω", true);
          return;
        }
      }
      showMessage(message, "–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å", false);
    }

    async function handleRegister() {
      const fullName = document.getElementById('register-fullname').value.trim();
      const phone = document.getElementById('register-phone').value.trim();
      const email = document.getElementById('register-email').value.trim();
      const password = document.getElementById('register-password').value;
      const message = document.getElementById('auth-message');
      if (!fullName || !phone || !email || !password) { showMessage(message, "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è", false); return; }
      if (password.length < 6) { showMessage(message, "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤", false); return; }
      if (localStorage.getItem(email)) { showMessage(message, "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç", false); return; }
      const firstCard = {
        id: Date.now().toString(),
        type: 'debit',
        number: generateCardNumber(),
        name: '–ú–æ—è –ø–µ—Ä–≤–∞—è –∫–∞—Ä—Ç–∞',
        balance: 1000,
        isPrimary: true,
        pin: '1234',
        expiry: '12/28'
      };
      const userData = {
        email, password, fullName, phone, isAdmin: false,
        cards: [firstCard], transactions: [], credits: []
      };
      localStorage.setItem(email, JSON.stringify(userData));
      currentUser = { email };
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      await sendTelegramMessage(`<b>üÜï –ù–û–í–ê–Ø –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</b>\nüë§ –ò–º—è: ${fullName}\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: ${phone}\nüìß Email: ${email}\nüí≥ –ö–∞—Ä—Ç–∞: ${firstCard.number}`);
      loadUserData();
      showBankScreen();
      showMessage(message, "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –ü–æ–¥–∞—Ä–æ–∫ 1000 —Å–æ–º.", true);
    }

    function initCreditCalculator() {
      const amount = document.getElementById('credit-amount');
      const term = document.getElementById('credit-term');
      const rate = document.getElementById('credit-rate');
      function update() {
        const a = parseFloat(amount.value) || 0;
        const t = parseInt(term.value);
        const r = parseFloat(rate.value) / 100 / 12;
        if (a <= 0) return;
        const monthly = a * r * Math.pow(1 + r, t) / (Math.pow(1 + r, t) - 1);
        document.getElementById('monthly-payment').textContent = formatAmount(monthly);
      }
      amount.addEventListener('input', update);
      term.addEventListener('change', update);
      rate.addEventListener('change', update);
      update();
    }

    async function handleCreditApplication() {
      if (!currentUser) { alert("–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É"); return; }
      const amount = parseFloat(document.getElementById('credit-modal-amount').value);
      const term = parseInt(document.getElementById('credit-modal-term').value);
      const userData = JSON.parse(localStorage.getItem(currentUser.email));
      const credit = { id: Date.now(), amount, term, status: 'pending', appliedAt: new Date().toISOString() };
      if (!userData.credits) userData.credits = [];
      userData.credits.push(credit);
      localStorage.setItem(currentUser.email, JSON.stringify(userData));
      await sendTelegramMessage(`<b>üí∞ –ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê –ù–ê –ö–†–ï–î–ò–¢</b>\nüë§ –ö–ª–∏–µ–Ω—Ç: ${userData.fullName}\nüíµ –°—É–º–º–∞: ${formatAmount(amount)}\nüìÜ –°—Ä–æ–∫: ${term} –º–µ—Å.`);
      document.getElementById('credit-modal').classList.add('hidden');
      alert("‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!");
      updateCreditsList();
    }

    function openCreditModal(type) {
      document.getElementById('credit-modal').classList.remove('hidden');
      if (type === 'consumer') document.getElementById('credit-modal-amount').value = 10000;
      else document.getElementById('credit-modal-amount').value = 50000;
    }

    function updateCreditsList() {
      const container = document.getElementById('my-credits-list');
      if (!currentUser) return;
      const userData = JSON.parse(localStorage.getItem(currentUser.email) || '{}');
      const credits = userData.credits || [];
      if (credits.length === 0) { container.innerHTML = '<p style="text-align:center; padding:24px;">–ù–µ—Ç –∫—Ä–µ–¥–∏—Ç–æ–≤</p>'; return; }
      container.innerHTML = credits.map(c => `<div style="background:#0f172a; padding:16px; border-radius:24px; margin-bottom:12px;"><div>–°—É–º–º–∞: ${formatAmount(c.amount)}</div><div>–°—Ä–æ–∫: ${c.term} –º–µ—Å.</div><div>–°—Ç–∞—Ç—É—Å: –ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</div></div>`).join('');
    }

    function generateCardNumber() {
      let num = '';
      for (let i = 0; i < 16; i++) {
        num += Math.floor(Math.random() * 10);
        if ((i + 1) % 4 === 0 && i < 15) num += ' ';
      }
      return num;
    }

    function formatAmount(amount) {
      return new Intl.NumberFormat('ru-RU', { style: 'currency', currency: 'TJS', minimumFractionDigits: 0 }).format(amount);
    }

    function showMessage(element, msg, success) {
      element.textContent = msg;
      element.className = `alert ${success ? 'alert-success' : 'alert-error'}`;
      element.classList.remove('hidden');
      if (success) setTimeout(() => element.classList.add('hidden'), 3000);
    }

    function showAuthScreen() {
      document.getElementById('auth-screen').classList.remove('hidden');
      document.getElementById('bank-screen').classList.add('hidden');
    }

    function showBankScreen() {
      document.getElementById('auth-screen').classList.add('hidden');
      document.getElementById('bank-screen').classList.remove('hidden');
    }

    function loadUserData() {
      const userData = JSON.parse(localStorage.getItem(currentUser.email) || '{}');
      userCards = userData.cards || [];
      userTransactions = userData.transactions || [];
      userCredits = userData.credits || [];
      updateUserDisplay();
      updateActiveCardDisplay();
      updateCardsList();
      updateRecentTransactions();
      updateQRCardSelector();
      updateCreditsList();
    }

    function saveUserData() {
      const userData = JSON.parse(localStorage.getItem(currentUser.email) || '{}');
      userData.cards = userCards;
      userData.transactions = userTransactions;
      userData.credits = userCredits;
      localStorage.setItem(currentUser.email, JSON.stringify(userData));
    }

    function updateUserDisplay() {
      const userData = JSON.parse(localStorage.getItem(currentUser.email) || '{}');
      document.getElementById('user-display-name').textContent = userData.fullName || currentUser.email;
      document.getElementById('admin-badge').classList.toggle('hidden', currentUser.email !== ADMIN_EMAIL);
    }

    function updateActiveCardDisplay() {
      if (userCards.length === 0) return;
      const card = userCards[activeCardIndex];
      const cardElement = document.getElementById('active-card-display');
      cardElement.style.background = card.type === 'gold' ? 'linear-gradient(145deg, #b45309, #92400e)' : card.type === 'platinum' ? 'linear-gradient(145deg, #4b5563, #1f2937)' : 'linear-gradient(145deg, #1e293b, #0f172a)';
      document.getElementById('active-card-type-label').textContent = CARD_TYPES[card.type]?.name || '–î–µ–±–µ—Ç–æ–≤–∞—è';
      document.getElementById('active-card-number').textContent = card.number;
      document.getElementById('active-card-name').textContent = card.name;
      document.getElementById('active-card-expiry').textContent = card.expiry;
      document.getElementById('balance').textContent = formatAmount(card.balance);
    }

    function updateCardsList() {
      const container = document.getElementById('cards-list');
      if (!container) return;
      if (userCards.length === 0) { container.innerHTML = '<div style="text-align:center;">–ù–µ—Ç –∫–∞—Ä—Ç</div>'; return; }
      container.innerHTML = userCards.map((card, i) => `
        <div class="card-item" style="background:${card.type==='gold'?'linear-gradient(145deg,#b45309,#92400e)':card.type==='platinum'?'linear-gradient(145deg,#4b5563,#1f2937)':'linear-gradient(145deg,#1e293b,#0f172a)'}; border-radius:24px; padding:20px; cursor:pointer;" onclick="selectCard(${i})">
          ${card.isPrimary ? '<div style="background:var(--primary); color:black; padding:4px 8px; border-radius:40px; font-size:12px; display:inline-block;">–û—Å–Ω–æ–≤–Ω–∞—è</div>' : ''}
          <div style="margin:12px 0;">${card.name}</div>
          <div style="font-family:monospace;">${card.number}</div>
          <div><strong>${formatAmount(card.balance)}</strong></div>
        </div>
      `).join('');
    }

    function updateQRCardSelector() {
      const select = document.getElementById('qr-card-select');
      if (!select) return;
      select.innerHTML = userCards.map((card, i) => `<option value="${i}">${card.name}</option>`).join('');
    }

    function updateRecentTransactions() {
      const container = document.getElementById('recent-transactions');
      if (!container) return;
      if (userTransactions.length === 0) {
        container.innerHTML = '<div style="text-align:center; padding:32px; color:var(--text-muted);"><span class="material-icons" style="font-size:48px;">payments</span><p>–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π</p></div>';
        return;
      }
      container.innerHTML = userTransactions.slice(0, 5).map(t => `
        <div style="display:flex; justify-content:space-between; padding:12px 0; border-bottom:1px solid #334155;">
          <div>${t.type === 'deposit' ? '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ' : '–ü–µ—Ä–µ–≤–æ–¥'}</div>
          <div>${formatAmount(t.amount)}</div>
        </div>
      `).join('');
    }

    function addTransaction(type, amount, comment, balanceAfter) {
      userTransactions.unshift({ id: Date.now(), type, amount, comment, timestamp: new Date().toISOString(), balanceAfter });
      saveUserData();
      updateRecentTransactions();
    }

    function selectCard(index) {
      activeCardIndex = index;
      updateActiveCardDisplay();
      updateQRCardSelector();
    }

    function generateQRCode() {
      const i = parseInt(document.getElementById('qr-card-select').value);
      if (i < 0 || i >= userCards.length) { alert("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É"); return; }
      const card = userCards[i];
      const link = window.location.origin + window.location.pathname + `?card=${card.number.replace(/\s/g, '')}`;
      const container = document.getElementById('qrcode-display');
      container.innerHTML = '';
      try {
        const qr = qrcode(0, 'M');
        qr.addData(link);
        qr.make();
        const canvas = document.createElement('canvas');
        canvas.width = 200; canvas.height = 200;
        const ctx = canvas.getContext('2d');
        ctx.fillStyle = '#FFFFFF'; ctx.fillRect(0,0,200,200);
        ctx.fillStyle = '#0a4d2e';
        const size = 200 / qr.getModuleCount();
        for (let r = 0; r < qr.getModuleCount(); r++) {
          for (let c = 0; c < qr.getModuleCount(); c++) {
            if (qr.isDark(r, c)) ctx.fillRect(c * size, r * size, size, size);
          }
        }
        container.appendChild(canvas);
        document.getElementById('qr-display-card-number').textContent = card.number;
        document.getElementById('qr-code-result').style.display = 'block';
      } catch (e) { alert("–û—à–∏–±–∫–∞"); }
    }

    function showQuickQRCode() {
      if (userCards.length === 0) { alert("–ù–µ—Ç –∫–∞—Ä—Ç"); return; }
      const card = userCards[activeCardIndex];
      const link = window.location.origin + window.location.pathname + `?card=${card.number.replace(/\s/g, '')}`;
      const container = document.getElementById('qrcode-modal');
      container.innerHTML = '';
      try {
        const qr = qrcode(0, 'M');
        qr.addData(link);
        qr.make();
        const canvas = document.createElement('canvas');
        canvas.width = 200; canvas.height = 200;
        const ctx = canvas.getContext('2d');
        ctx.fillStyle = '#FFFFFF'; ctx.fillRect(0,0,200,200);
        ctx.fillStyle = '#0a4d2e';
        const size = 200 / qr.getModuleCount();
        for (let r = 0; r < qr.getModuleCount(); r++) {
          for (let c = 0; c < qr.getModuleCount(); c++) {
            if (qr.isDark(r, c)) ctx.fillRect(c * size, r * size, size, size);
          }
        }
        container.appendChild(canvas);
        document.getElementById('qr-modal-card-number').textContent = card.number;
        document.getElementById('qr-modal').classList.remove('hidden');
      } catch (e) { alert("–û—à–∏–±–∫–∞"); }
    }

    function handleDeposit() {
      const amount = parseFloat(document.getElementById('deposit-amount').value);
      const pin = document.getElementById('deposit-pin').value;
      const msg = document.getElementById('deposit-message');
      if (!amount || amount <= 0) { showMessage(msg, "–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É", false); return; }
      const card = userCards[activeCardIndex];
      if (pin !== card.pin) { showMessage(msg, "–ù–µ–≤–µ—Ä–Ω—ã–π PIN", false); return; }
      card.balance += amount;
      addTransaction('deposit', amount, '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ', card.balance);
      saveUserData();
      updateActiveCardDisplay();
      showMessage(msg, `–ü–æ–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ ${formatAmount(amount)}`, true);
      setTimeout(() => document.getElementById('deposit-modal').classList.add('hidden'), 1500);
    }

    function handleTransfer() {
      const to = document.getElementById('recipient-card').value.replace(/\s/g, '');
      const amount = parseFloat(document.getElementById('transfer-amount').value);
      const pin = document.getElementById('transfer-pin').value;
      const msg = document.getElementById('transfer-message');
      if (!to || to.length !== 16) { showMessage(msg, "–ù–µ–≤–µ—Ä–Ω—ã–π –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã", false); return; }
      if (!amount || amount <= 0) { showMessage(msg, "–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É", false); return; }
      const card = userCards[activeCardIndex];
      if (pin !== card.pin) { showMessage(msg, "–ù–µ–≤–µ—Ä–Ω—ã–π PIN", false); return; }
      const total = amount * 1.01;
      if (total > card.balance) { showMessage(msg, `–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤`, false); return; }
      let found = false;
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.includes('@')) {
          const data = JSON.parse(localStorage.getItem(key));
          const recipient = data.cards?.find(c => c.number.replace(/\s/g, '') === to);
          if (recipient) {
            recipient.balance += amount;
            localStorage.setItem(key, JSON.stringify(data));
            found = true;
            break;
          }
        }
      }
      if (!found) { showMessage(msg, "–ö–∞—Ä—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞", false); return; }
      card.balance -= total;
      addTransaction('transfer', amount, '–ü–µ—Ä–µ–≤–æ–¥', card.balance);
      saveUserData();
      updateActiveCardDisplay();
      showMessage(msg, `–ü–µ—Ä–µ–≤–µ–¥–µ–Ω–æ ${formatAmount(amount)}`, true);
      setTimeout(() => document.getElementById('transfer-modal').classList.add('hidden'), 1500);
    }

    function handleAddCard() {
      const type = document.getElementById('new-card-type').value;
      const name = document.getElementById('new-card-name').value.trim() || CARD_TYPES[type].name;
      const msg = document.getElementById('add-card-message');
      const info = CARD_TYPES[type];
      const card = userCards[activeCardIndex];
      if (info.price > 0 && info.price > card.balance) { showMessage(msg, `–ù—É–∂–Ω–æ: ${info.price} —Å–æ–º.`, false); return; }
      const newCard = {
        id: Date.now().toString(),
        type,
        number: generateCardNumber(),
        name,
        balance: 0,
        isPrimary: false,
        pin: '1234',
        expiry: '12/28'
      };
      if (type !== 'debit') {
        card.balance -= info.price;
        addTransaction('purchase', info.price, `–ü–æ–∫—É–ø–∫–∞ ${info.name}`, card.balance);
      }
      userCards.push(newCard);
      saveUserData();
      showMessage(msg, `–ö–∞—Ä—Ç–∞ "${name}" –¥–æ–±–∞–≤–ª–µ–Ω–∞`, true);
      setTimeout(() => {
        document.getElementById('add-card-modal').classList.add('hidden');
        updateActiveCardDisplay();
        updateCardsList();
        updateQRCardSelector();
      }, 1500);
    }

    function purchaseCard(type) {
      const info = CARD_TYPES[type];
      const card = userCards[activeCardIndex];
      if (info.price > card.balance) { alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤! –ù—É–∂–Ω–æ: ${info.price} —Å–æ–º.`); return; }
      if (!confirm(`–ö—É–ø–∏—Ç—å ${info.name} –∫–∞—Ä—Ç—É –∑–∞ ${info.price} —Å–æ–º.?`)) return;
      const newCard = {
        id: Date.now().toString(),
        type,
        number: generateCardNumber(),
        name: info.name,
        balance: 0,
        isPrimary: false,
        pin: '1234',
        expiry: '12/28'
      };
      card.balance -= info.price;
      userCards.push(newCard);
      addTransaction('purchase', info.price, `–ü–æ–∫—É–ø–∫–∞ ${info.name}`, card.balance);
      saveUserData();
      alert(`‚úÖ ${info.name} –∫–∞—Ä—Ç–∞ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∞!`);
      updateActiveCardDisplay();
      updateCardsList();
      updateQRCardSelector();
    }

    function showTransactionHistory() {
      if (userTransactions.length === 0) { alert("–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞"); return; }
      let text = "–ò–°–¢–û–†–ò–Ø\n\n";
      userTransactions.slice(0, 10).forEach((t, i) => { text += `${i+1}. ${t.type === 'deposit' ? '+' : '-'}${formatAmount(t.amount)}\n`; });
      alert(text);
    }

    function handleLogout() {
      if (confirm("–í—ã–π—Ç–∏?")) {
        currentUser = null;
        localStorage.removeItem('currentUser');
        showAuthScreen();
      }
    }

    function setupEventListeners() {
      document.getElementById('login-btn').addEventListener('click', handleLogin);
      document.getElementById('register-btn').addEventListener('click', handleRegister);
      document.getElementById('logout-btn').addEventListener('click', handleLogout);

      document.getElementById('show-register').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('login-form').style.display = 'none';
        document.getElementById('register-form').style.display = 'block';
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        document.getElementById('tab-reg').classList.add('active');
      });
      document.getElementById('show-login').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('login-form').style.display = 'block';
        document.getElementById('register-form').style.display = 'none';
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        document.getElementById('tab-login').classList.add('active');
      });
      document.getElementById('tab-login').addEventListener('click', () => {
        document.getElementById('login-form').style.display = 'block';
        document.getElementById('register-form').style.display = 'none';
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        document.getElementById('tab-login').classList.add('active');
      });
      document.getElementById('tab-reg').addEventListener('click', () => {
        document.getElementById('login-form').style.display = 'none';
        document.getElementById('register-form').style.display = 'block';
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        document.getElementById('tab-reg').classList.add('active');
      });

      document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function() {
          document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
          this.classList.add('active');
          document.getElementById(`${this.dataset.tab}-tab`).classList.remove('hidden');
        });
      });

      document.getElementById('add-card-btn').addEventListener('click', () => {
        document.getElementById('add-card-modal').classList.remove('hidden');
      });
      document.getElementById('confirm-add-card').addEventListener('click', handleAddCard);
      document.getElementById('confirm-deposit').addEventListener('click', handleDeposit);
      document.getElementById('confirm-transfer').addEventListener('click', handleTransfer);
      document.getElementById('apply-credit-btn').addEventListener('click', () => openCreditModal('consumer'));
      document.getElementById('confirm-credit-btn').addEventListener('click', handleCreditApplication);
      document.getElementById('generate-qr-btn').addEventListener('click', generateQRCode);
      document.getElementById('view-all-btn').addEventListener('click', showTransactionHistory);

      document.querySelectorAll('.get-card-btn').forEach(btn => {
        btn.addEventListener('click', function() { purchaseCard(this.dataset.cardType); });
      });

      document.querySelectorAll('.modal-close, .close-modal').forEach(btn => {
        btn.addEventListener('click', function() { this.closest('.modal').classList.add('hidden'); });
      });
    }

    window.addEventListener('load', initApp);
  </script>
</body>
</html>
